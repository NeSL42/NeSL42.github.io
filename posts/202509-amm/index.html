<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>恒定乘积自动做市商 (CPAMM) 学习笔记 - 敬渊&#39;s Blog</title><meta name="author" content="">
<meta name="description" content="恒定乘积自动做市商 (CPAMM) 学习笔记 核心摘要 (Key Takeaways) CPAMM 核心公式：$X \times Y = K$ 是恒定乘积自动做市商（Constant Product Automated Market Maker, CPAMM）的核心，它定义了去中心化交易所（DEX）中流动性池中两种资产数量的关系。 DEFI 基石：该公式是 2020-2021 年 DEFI 浪潮的起点，支撑了数百亿美元的 DEFI 市值发展，实现了无需中心化对手方的代币交换。 交换中的 K 值恒定：在用户进行代币买卖（Swap）时，池子的总流动性 $K$ 保持不变，但池中两种代币的比例会根据交易量动态调整。 滑点 (Slippage)：交易量相对于池子总流动性的比例越大，交易产生的滑点就越大，导致实际成交价格偏离预期市场价格。用户在交易时可设置滑点容忍度。 流动性提供者 (LP)：用户可以通过向池子提供两种代币，成为流动性提供者，获得 LP 凭证 (LPT) 并赚取交易手续费；添加和移除流动性会改变 $K$ 值。 1. 恒定乘积自动做市商 (CPAMM) 核心原理 1.1 定义与核心公式
"><meta name="keywords" content='Web3'>
  <meta itemprop="name" content="恒定乘积自动做市商 (CPAMM) 学习笔记">
  <meta itemprop="description" content="恒定乘积自动做市商 (CPAMM) 学习笔记 核心摘要 (Key Takeaways) CPAMM 核心公式：$X \times Y = K$ 是恒定乘积自动做市商（Constant Product Automated Market Maker, CPAMM）的核心，它定义了去中心化交易所（DEX）中流动性池中两种资产数量的关系。 DEFI 基石：该公式是 2020-2021 年 DEFI 浪潮的起点，支撑了数百亿美元的 DEFI 市值发展，实现了无需中心化对手方的代币交换。 交换中的 K 值恒定：在用户进行代币买卖（Swap）时，池子的总流动性 $K$ 保持不变，但池中两种代币的比例会根据交易量动态调整。 滑点 (Slippage)：交易量相对于池子总流动性的比例越大，交易产生的滑点就越大，导致实际成交价格偏离预期市场价格。用户在交易时可设置滑点容忍度。 流动性提供者 (LP)：用户可以通过向池子提供两种代币，成为流动性提供者，获得 LP 凭证 (LPT) 并赚取交易手续费；添加和移除流动性会改变 $K$ 值。 1. 恒定乘积自动做市商 (CPAMM) 核心原理 1.1 定义与核心公式">
  <meta itemprop="datePublished" content="2025-08-30T00:00:00+00:00">
  <meta itemprop="dateModified" content="2025-08-30T00:00:00+00:00">
  <meta itemprop="wordCount" content="4769">
  <meta itemprop="keywords" content="Web3"><meta property="og:url" content="http://localhost:1313/posts/202509-amm/">
  <meta property="og:site_name" content="敬渊&#39;s Blog">
  <meta property="og:title" content="恒定乘积自动做市商 (CPAMM) 学习笔记">
  <meta property="og:description" content="恒定乘积自动做市商 (CPAMM) 学习笔记 核心摘要 (Key Takeaways) CPAMM 核心公式：$X \times Y = K$ 是恒定乘积自动做市商（Constant Product Automated Market Maker, CPAMM）的核心，它定义了去中心化交易所（DEX）中流动性池中两种资产数量的关系。 DEFI 基石：该公式是 2020-2021 年 DEFI 浪潮的起点，支撑了数百亿美元的 DEFI 市值发展，实现了无需中心化对手方的代币交换。 交换中的 K 值恒定：在用户进行代币买卖（Swap）时，池子的总流动性 $K$ 保持不变，但池中两种代币的比例会根据交易量动态调整。 滑点 (Slippage)：交易量相对于池子总流动性的比例越大，交易产生的滑点就越大，导致实际成交价格偏离预期市场价格。用户在交易时可设置滑点容忍度。 流动性提供者 (LP)：用户可以通过向池子提供两种代币，成为流动性提供者，获得 LP 凭证 (LPT) 并赚取交易手续费；添加和移除流动性会改变 $K$ 值。 1. 恒定乘积自动做市商 (CPAMM) 核心原理 1.1 定义与核心公式">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-08-30T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-08-30T00:00:00+00:00">
    <meta property="article:tag" content="Web3">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="恒定乘积自动做市商 (CPAMM) 学习笔记">
  <meta name="twitter:description" content="恒定乘积自动做市商 (CPAMM) 学习笔记 核心摘要 (Key Takeaways) CPAMM 核心公式：$X \times Y = K$ 是恒定乘积自动做市商（Constant Product Automated Market Maker, CPAMM）的核心，它定义了去中心化交易所（DEX）中流动性池中两种资产数量的关系。 DEFI 基石：该公式是 2020-2021 年 DEFI 浪潮的起点，支撑了数百亿美元的 DEFI 市值发展，实现了无需中心化对手方的代币交换。 交换中的 K 值恒定：在用户进行代币买卖（Swap）时，池子的总流动性 $K$ 保持不变，但池中两种代币的比例会根据交易量动态调整。 滑点 (Slippage)：交易量相对于池子总流动性的比例越大，交易产生的滑点就越大，导致实际成交价格偏离预期市场价格。用户在交易时可设置滑点容忍度。 流动性提供者 (LP)：用户可以通过向池子提供两种代币，成为流动性提供者，获得 LP 凭证 (LPT) 并赚取交易手续费；添加和移除流动性会改变 $K$ 值。 1. 恒定乘积自动做市商 (CPAMM) 核心原理 1.1 定义与核心公式">
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="http://localhost:1313/posts/202509-amm/" title="恒定乘积自动做市商 (CPAMM) 学习笔记 - 敬渊&#39;s Blog" /><link rel="prev" type="text/html" href="http://localhost:1313/posts/202508-tao/" title="Lex Fridman播客:陶哲轩：数学、物理学中最难的问题以及人工智能的未来" /><link rel="next" type="text/html" href="http://localhost:1313/posts/202509-jiedai/" title="去中心化借贷" /><link rel="stylesheet" href="/css/config.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "恒定乘积自动做市商 (CPAMM) 学习笔记",
    "inLanguage": "zh-CN",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/localhost:1313\/posts\/202509-amm\/"
    },"genre": "posts","keywords": "Web3","wordcount":  4769 ,
    "url": "http:\/\/localhost:1313\/posts\/202509-amm\/","datePublished": "2025-08-30T00:00:00+00:00","dateModified": "2025-08-30T00:00:00+00:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "作者"
      },"description": ""
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-instant-intensity="viewport" data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="敬渊&#39;s Blog"><span class="header-title-text">敬渊&#39;s Blog</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/posts/">文章</a></li><li class="menu-item">
              <a class="menu-link" href="/tags/">标签</a></li><li class="menu-item">
              <a class="menu-link" href="/about/">关于</a></li><li class="menu-item">
              <a class="menu-link" href="/categories/">分类</a></li><li class="menu-item delimiter"></li><li class="menu-item theme-switch" role="button" aria-label="切换主题" title="切换主题"><i class="fa-solid fa-adjust" aria-hidden="true"></i></li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="敬渊&#39;s Blog"><span class="header-title-text">敬渊&#39;s Blog</span></a><span class="header-subtitle"></span></div>
      <div class="theme-switch" role="button" aria-label="切换主题"><i class="fa-solid fa-adjust" aria-hidden="true"></i></div>
      <div class="menu-toggle" id="menu-toggle-mobile" role="button" aria-labelledby="menu-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="menu-item"><a class="menu-link" href="/posts/">文章</a></li><li class="menu-item"><a class="menu-link" href="/tags/">标签</a></li><li class="menu-item"><a class="menu-link" href="/about/">关于</a></li><li class="menu-item"><a class="menu-link" href="/categories/">分类</a></li><li class="menu-item menu-system"></li>
      </ul>
    </nav>
  </div>
</header><main class="fi-container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="合集"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>恒定乘积自动做市商 (CPAMM) 学习笔记</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><i class="fa-solid fa-user-circle" aria-hidden="true"></i>
      Anonymous</span></span><span class="post-included-in">&nbsp;收录于 <a href="/categories/technology/" class="post-category" title="分类 - Technology"><i class="fa-regular fa-folder" aria-hidden="true"></i> Technology</a></span></div><div class="post-meta-line"><span title="发布于 2025-08-30 00:00:00"><i class="fa-solid fa-calendar-days me-1" aria-hidden="true"></i><time datetime="2025-08-30">2025-08-30</time></span>&nbsp;<span title="4769 字"><i class="fa-solid fa-pencil-alt me-1" aria-hidden="true"></i>约 4800 字</span>&nbsp;<span><i class="fa-regular fa-clock me-1" aria-hidden="true"></i>预计阅读 10 分钟</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>目录</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#恒定乘积自动做市商-cpamm-学习笔记">恒定乘积自动做市商 (CPAMM) 学习笔记</a>
      <ul>
        <li><a href="#核心摘要-key-takeaways">核心摘要 (Key Takeaways)</a></li>
        <li><a href="#1-恒定乘积自动做市商-cpamm-核心原理">1. 恒定乘积自动做市商 (CPAMM) 核心原理</a></li>
        <li><a href="#2-案例展示与计算">2. 案例展示与计算</a></li>
        <li><a href="#3-价格与滑点-slippage">3. 价格与滑点 (Slippage)</a></li>
        <li><a href="#4-流动性与提供者">4. 流动性与提供者</a></li>
        <li><a href="#5-添加与移除流动性">5. 添加与移除流动性</a></li>
        <li><a href="#6-amm-交易流程-mermaid-diagram">6. AMM 交易流程 (Mermaid Diagram)</a></li>
        <li><a href="#7-总结">7. 总结</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h2 class="heading-element" id="恒定乘积自动做市商-cpamm-学习笔记"><span>恒定乘积自动做市商 (CPAMM) 学习笔记</span>
  <a href="#%e6%81%92%e5%ae%9a%e4%b9%98%e7%a7%af%e8%87%aa%e5%8a%a8%e5%81%9a%e5%b8%82%e5%95%86-cpamm-%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="核心摘要-key-takeaways"><span>核心摘要 (Key Takeaways)</span>
  <a href="#%e6%a0%b8%e5%bf%83%e6%91%98%e8%a6%81-key-takeaways" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><strong>CPAMM 核心公式</strong>：$X \times Y = K$ 是恒定乘积自动做市商（Constant Product Automated Market Maker, CPAMM）的核心，它定义了去中心化交易所（DEX）中流动性池中两种资产数量的关系。</li>
<li><strong>DEFI 基石</strong>：该公式是 2020-2021 年 DEFI 浪潮的起点，支撑了数百亿美元的 DEFI 市值发展，实现了无需中心化对手方的代币交换。</li>
<li><strong>交换中的 K 值恒定</strong>：在用户进行代币买卖（Swap）时，池子的总流动性 $K$ 保持不变，但池中两种代币的比例会根据交易量动态调整。</li>
<li><strong>滑点 (Slippage)</strong>：交易量相对于池子总流动性的比例越大，交易产生的滑点就越大，导致实际成交价格偏离预期市场价格。用户在交易时可设置<strong>滑点容忍度</strong>。</li>
<li><strong>流动性提供者 (LP)</strong>：用户可以通过向池子提供两种代币，成为流动性提供者，获得 LP 凭证 (LPT) 并赚取交易手续费；添加和移除流动性会改变 $K$ 值。</li>
</ul>
<hr>
<h3 class="heading-element" id="1-恒定乘积自动做市商-cpamm-核心原理"><span>1. 恒定乘积自动做市商 (CPAMM) 核心原理</span>
  <a href="#1-%e6%81%92%e5%ae%9a%e4%b9%98%e7%a7%af%e8%87%aa%e5%8a%a8%e5%81%9a%e5%b8%82%e5%95%86-cpamm-%e6%a0%b8%e5%bf%83%e5%8e%9f%e7%90%86" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p><strong>1.1 定义与核心公式</strong></p>
<ul>
<li><strong>名称</strong>：<strong>恒定乘积自动做市商 (Constant Product Automated Market Maker, CPAMM)</strong>，简称 <strong>AMM</strong> 或 <strong>CPMM</strong>。</li>
<li><strong>核心公式</strong>：
$$
X \times Y = K
$$
<ul>
<li><strong>X</strong>：池中 <strong>token0</strong> 的数量。</li>
<li><strong>Y</strong>：池中 <strong>token1</strong> 的数量。</li>
<li><strong>K</strong>：池子的总<strong>流动性 (Liquidity)</strong>。在用户进行代币交换（Swap）时，K 值保持恒定。</li>
</ul>
</li>
<li><strong>数学图像</strong>：如果将公式表示为 $Y = K/X$，其在坐标系中呈现为一条<strong>双曲线</strong>。在这条曲线上的任何点，X 和 Y 的乘积都等于 K。</li>
<li><strong>对比</strong>：与恒定乘积 AMM 相对，还有理论上的<strong>恒定和自动做市商 (Constant Sum AMM)</strong>，其公式为 $X + Y = K$。但这种模型在实际中几乎不被使用，因为它无法在不耗尽其中一种资产的情况下支持无限交易。</li>
</ul>
<p><strong>1.2 DEFI 中的重要性</strong></p>
<ul>
<li>CPAMM 公式是 Uniswap 等去中心化交易所（DEX）的核心机制，直接推动了 DEFI 市场的爆发式增长，实现了无需传统订单簿的自动化做市。</li>
</ul>
<p><strong>1.3 交易机制</strong></p>
<p>CPAMM 允许用户在没有中心化对手方的情况下进行代币交换。其基本逻辑是：当一种代币进入池子，另一种代币就会流出池子，以维持 $X \times Y = K$ 的恒定乘积。</p>
<ul>
<li><strong>用户卖出 token0 (买入 token1)</strong>：
<ul>
<li>用户将 $\Delta X$ 数量的 token0 卖给池子。</li>
<li>池中 token0 数量增加：$X \rightarrow X + \Delta X$。</li>
<li>为了保持 $K$ 值不变，池中 token1 数量必须减少：$Y \rightarrow Y - \Delta Y$。</li>
<li>公式变为：$(X + \Delta X) \times (Y - \Delta Y) = K$</li>
</ul>
</li>
<li><strong>用户买入 token0 (卖出 token1)</strong>：
<ul>
<li>用户从池子中买入 $\Delta X$ 数量的 token0。</li>
<li>池中 token0 数量减少：$X \rightarrow X - \Delta X$。</li>
<li>为了保持 $K$ 值不变，池中 token1 数量必须增加：$Y \rightarrow Y + \Delta Y$。</li>
<li>公式变为：$(X - \Delta X) \times (Y + \Delta Y) = K$</li>
</ul>
</li>
</ul>
<hr>
<h3 class="heading-element" id="2-案例展示与计算"><span>2. 案例展示与计算</span>
  <a href="#2-%e6%a1%88%e4%be%8b%e5%b1%95%e7%a4%ba%e4%b8%8e%e8%ae%a1%e7%ae%97" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>以下案例均基于一个初始的 ETH/USDT 交易对池：</p>
<ul>
<li><strong>ETH (X)</strong> = 10 个</li>
<li><strong>USDT (Y)</strong> = 20,000 个</li>
<li><strong>初始流动性 (K)</strong> = $10 \times 20,000 = 200,000$</li>
</ul>
<p><strong>2.1 场景一：用户卖出 5 ETH (买入 USDT)</strong></p>
<ul>
<li><strong>操作</strong>：用户向池子卖出 5 ETH。</li>
<li><strong>池子变化</strong>：
<ul>
<li>ETH 数量变为：$10 + 5 = 15$</li>
<li>USDT 数量变为：$20,000 - \Delta Y$</li>
</ul>
</li>
<li><strong>计算 $\Delta Y$</strong>：
$$(10 + 5) \times (20,000 - \Delta Y) = 200,000$$
$$15 \times (20,000 - \Delta Y) = 200,000$$
$$20,000 - \Delta Y = \frac{200,000}{15} \approx 13333.33$$
$$\Delta Y = 20,000 - 13333.33 = 6666.67$$</li>
<li><strong>结果</strong>：用户卖出 5 ETH，可以获得 <strong>6666.67 USDT</strong>。</li>
</ul>
<p><strong>2.2 场景二：用户持有 10,000 USDT 买入 ETH</strong></p>
<ul>
<li><strong>操作</strong>：用户向池子卖出 10,000 USDT，买入 ETH。</li>
<li><strong>池子变化</strong>：
<ul>
<li>USDT 数量变为：$20,000 + 10,000 = 30,000$</li>
<li>ETH 数量变为：$10 - \Delta X$</li>
</ul>
</li>
<li><strong>计算 $\Delta X$</strong>：
$$(10 - \Delta X) \times (20,000 + 10,000) = 200,000$$
$$(10 - \Delta X) \times 30,000 = 200,000$$
$$10 - \Delta X = \frac{200,000}{30,000} \approx 6.67$$
$$\Delta X = 10 - 6.67 = 3.33$$</li>
<li><strong>结果</strong>：用户用 10,000 USDT，可以买入 <strong>3.33 ETH</strong>。</li>
</ul>
<p><strong>2.3 场景三：极端情况 - 用户卖出 100,000 ETH</strong></p>
<ul>
<li><strong>操作</strong>：用户向池子卖出 100,000 ETH (远超池中 ETH 数量)。</li>
<li><strong>池子变化</strong>：
<ul>
<li>ETH 数量变为：$10 + 100,000 = 100,010$</li>
<li>USDT 数量变为：$20,000 - \Delta Y$</li>
</ul>
</li>
<li><strong>计算 $\Delta Y$</strong>：
$$(10 + 100,000) \times (20,000 - \Delta Y) = 200,000$$
$$100,010 \times (20,000 - \Delta Y) = 200,000$$
$$20,000 - \Delta Y = \frac{200,000}{100,010} \approx 1.9998$$
$$\Delta Y = 20,000 - 1.9998 = 19998.0002$$</li>
<li><strong>结果</strong>：用户卖出 100,000 ETH，可以获得约 <strong>19998 USDT</strong>。</li>
<li><strong>分析</strong>：即使交易量远超池中现有资产，CPAMM 理论上也能完成交易。池子中的 USDT 会被几乎掏空，但永远不会完全为零，会无限接近于零。这表明 CPAMM 曲线可以支撑代币在<strong>任何价格</strong>上的买卖。</li>
</ul>
<p><strong>2.4 场景四：小额交易 - 用户卖出 0.01 ETH</strong></p>
<ul>
<li><strong>操作</strong>：用户向池子卖出 0.01 ETH。</li>
<li><strong>池子变化</strong>：
<ul>
<li>ETH 数量变为：$10 + 0.01 = 10.01$</li>
<li>USDT 数量变为：$20,000 - \Delta Y$</li>
</ul>
</li>
<li><strong>计算 $\Delta Y$</strong>：
$$(10 + 0.01) \times (20,000 - \Delta Y) = 200,000$$
$$10.01 \times (20,000 - \Delta Y) = 200,000$$
$$20,000 - \Delta Y = \frac{200,000}{10.01} \approx 19980.01998$$
$$\Delta Y = 20,000 - 19980.01998 \approx 19.98$$</li>
<li><strong>结果</strong>：用户卖出 0.01 ETH，可以获得约 <strong>19.98 USDT</strong>。</li>
<li><strong>分析</strong>：小额交易对池子影响小，执行价格会非常接近市场价。</li>
</ul>
<hr>
<h3 class="heading-element" id="3-价格与滑点-slippage"><span>3. 价格与滑点 (Slippage)</span>
  <a href="#3-%e4%bb%b7%e6%a0%bc%e4%b8%8e%e6%bb%91%e7%82%b9-slippage" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p><strong>3.1 价格决定机制</strong></p>
<ul>
<li><strong>市场供需</strong>：CPAMM 池中代币的价格由市场供需关系自动决定。</li>
<li><strong>套利机器人</strong>：如果池内价格与外部市场价格出现差异，套利机器人会迅速介入，通过在价格较低的池子买入并在价格较高的市场卖出，从而将池内价格“搬平”，使其与市场价保持一致。</li>
</ul>
<p><strong>3.2 即时价格 (Spot Price)</strong></p>
<ul>
<li><strong>定义</strong>：池中两种 token 数量的<strong>比值</strong>，代表当前池子的理论价格。</li>
<li><strong>公式</strong>：
<ul>
<li>$P_{token0} = Y/X$</li>
<li>$P_{token1} = X/Y$</li>
</ul>
</li>
<li><strong>初始价格计算 (基于初始池子)</strong>：
$$P_{ETH} = \frac{20,000 \text{ USDT}}{10 \text{ ETH}} = 2000 \text{ USDT/ETH}$$
$$P_{USDT} = \frac{10 \text{ ETH}}{20,000 \text{ USDT}} = 0.0005 \text{ ETH/USDT}$$</li>
</ul>
<p><strong>3.3 滑点 (Slippage)</strong></p>
<ul>
<li><strong>定义</strong>：衡量实际成交价格与预期市场价格之间的差异。在 DEX 中，由于交易会改变池中代币的比例，大额交易会导致价格显著偏离即时价格。</li>
<li><strong>公式</strong>：
$$
Slippage = \frac{\text{Execution Price} - \text{Expected Price}}{\text{Expected Price}} \times 100%
$$
<ul>
<li><strong>Execution Price (执行价格)</strong>：实际成交的单价。</li>
<li><strong>Expected Price (预期价格)</strong>：交易发生前的即时价格 (Spot Price)。</li>
</ul>
</li>
<li><strong>滑点容忍度 (Slippage Tolerance)</strong>：用户在进行交易时可以设置的最大可接受滑点百分比。如果实际滑点超过此容忍度，交易将失败。</li>
<li><strong>案例滑点计算</strong>：
<ul>
<li><strong>场景一 (卖出 5 ETH)</strong>：
<ul>
<li>预期价格：2000 USDT/ETH</li>
<li>执行价格：$$\frac{6666.67 \text{ USDT}}{5 \text{ ETH}} = 1333.33 \text{ USDT/ETH}$$</li>
<li>滑点：$$\frac{1333.33 - 2000}{2000} \times 100% = -33.33%$$ (用户实际卖出价格远低于预期)</li>
</ul>
</li>
<li><strong>场景二 (买入 3.33 ETH)</strong>：
<ul>
<li>预期价格：2000 USDT/ETH</li>
<li>执行价格：$$\frac{10000 \text{ USDT}}{3.33 \text{ ETH}} = 3003 \text{ USDT/ETH}$$</li>
<li>滑点：$$\frac{3003 - 2000}{2000} \times 100% = 50.15%$$ (用户实际买入价格远高于预期)</li>
</ul>
</li>
<li><strong>场景三 (卖出 100,000 ETH)</strong>：
<ul>
<li>预期价格：2000 USDT/ETH</li>
<li>执行价格：$$\frac{19998 \text{ USDT}}{100000 \text{ ETH}} = 0.2 \text{ USDT/ETH}$$</li>
<li>滑点：$$\frac{0.2 - 2000}{2000} \times 100% \approx -99.99%$$ (极端亏损)</li>
</ul>
</li>
<li><strong>场景四 (卖出 0.01 ETH)</strong>：
<ul>
<li>预期价格：2000 USDT/ETH</li>
<li>执行价格：$$\frac{19.98 \text{ USDT}}{0.01 \text{ ETH}} = 1998 \text{ USDT/ETH}$$</li>
<li>滑点：$$\frac{1998 - 2000}{2000} \times 100% = -0.1%$$ (滑点很小，接近市场价)</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>3.4 滑点影响因素与池子深度</strong></p>
<ul>
<li><strong>交易量比例</strong>：交易量占池子总流动性的比例越大，产生的滑点越大。</li>
<li><strong>池子深度 (Liquidity Depth)</strong>：
<ul>
<li><strong>定义</strong>：衡量池子中总流动性的大小。K 值（或 L 值）越大，池子越深。</li>
<li><strong>影响</strong>：池子越深，对于相同交易量的冲击（<strong>Price Impact</strong>）越小，交易产生的滑点也越小。</li>
<li><strong>大户交易</strong>：大额交易者需要寻找深度足够的流动性池，以确保交易以接近市场价的价格成交，减少磨损。</li>
</ul>
</li>
</ul>
<hr>
<h3 class="heading-element" id="4-流动性与提供者"><span>4. 流动性与提供者</span>
  <a href="#4-%e6%b5%81%e5%8a%a8%e6%80%a7%e4%b8%8e%e6%8f%90%e4%be%9b%e8%80%85" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p><strong>4.1 流动性 (Liquidity)</strong></p>
<ul>
<li><strong>K 值</strong>：直接表示 $X \times Y$ 的乘积，可以用来衡量流动性的大小。</li>
<li><strong>L 值</strong>：在实际应用中，为了保持量纲一致性（例如，如果 X 和 Y 都是 token 数量，K 的量纲是 token 数量的平方），通常使用 $L = \sqrt{X \times Y}$ 来表示流动性。L 值与 K 值同样可以衡量池子的深浅。</li>
</ul>
<p><strong>4.2 流动性提供者 (Liquidity Provider, LP)</strong></p>
<ul>
<li><strong>定义</strong>：向交易池提供两种代币资产以增加流动性的用户。</li>
<li><strong>动机</strong>：通过提供流动性，LP 可以赚取该池子中所有交易产生的手续费。</li>
<li><strong>行业术语</strong>：
<ul>
<li>“做 LP”：指提供流动性。</li>
<li>“LP 赚了很多钱”：指通过提供流动性赚取了手续费。</li>
</ul>
</li>
</ul>
<p><strong>4.3 LP 凭证 (Liquidity Provider Token, LPT)</strong></p>
<ul>
<li><strong>定义</strong>：LP 提供流动性后，会收到一个代表其在池中份额的凭证代币。</li>
<li><strong>作用</strong>：LPT 证明了 LP 对池子的所有权，可以用来赎回其提供的流动性及赚取的手续费。</li>
<li><strong>协议标准</strong>：
<ul>
<li><strong>Uniswap V2</strong>：LPT 通常是 <strong>ERC-20</strong> 协议代币。</li>
<li><strong>Uniswap V3</strong>：LPT 是 <strong>ERC-721</strong> 协议的 NFT，因为 V3 引入了集中流动性，每个 LP 头寸都是独特的。</li>
</ul>
</li>
</ul>
<hr>
<h3 class="heading-element" id="5-添加与移除流动性"><span>5. 添加与移除流动性</span>
  <a href="#5-%e6%b7%bb%e5%8a%a0%e4%b8%8e%e7%a7%bb%e9%99%a4%e6%b5%81%e5%8a%a8%e6%80%a7" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p><strong>5.1 添加流动性 (Add Liquidity)</strong></p>
<ul>
<li><strong>原则</strong>：LP 在添加流动性时，必须按照当前池中两种代币的<strong>市场价格比例</strong>（即 $X:Y$ 比例）进行添加。
<ul>
<li><strong>公式</strong>：$$\frac{X_{new}}{Y_{new}} = \frac{X_{old}}{Y_{old}}$$即 $$\frac{X + \Delta X}{Y + \Delta Y} = \frac{X}{Y}$$</li>
<li><strong>原因</strong>：如果 LP 不按比例添加，会直接改变池子的价格，并立即被套利机器人“搬平”，导致 LP 承担损失。</li>
</ul>
</li>
<li><strong>初始流动性</strong>：
<ul>
<li>对于一个新发行的代币，项目方首次在 DEX 上线并提供流动性时，这被称为<strong>添加初始流动性</strong>。</li>
<li><strong>初始流动性决定了该代币的初始发行价格（或开盘价）</strong>。</li>
</ul>
</li>
<li><strong>K 值变化</strong>：添加流动性时，池中的 $X$ 和 $Y$ 都会增加，因此 <strong>K 值会增加</strong> ($K_{new} &gt; K_{old}$)。</li>
</ul>
<p><strong>5.2 移除流动性 (Remove Liquidity)</strong></p>
<ul>
<li><strong>原则</strong>：LP 在移除流动性时，也是按照<strong>移除时池子的当前比例</strong>进行移除。
<ul>
<li><strong>公式</strong>：$$\frac{X_{removed}}{Y_{removed}} = \frac{X_{current}}{Y_{current}}$$。</li>
</ul>
</li>
<li><strong>重要性</strong>：由于市场交易可能导致池中 $X:Y$ 的比例发生变化，LP 移除流动性时获得的两种代币数量，很可能与最初添加时的数量<strong>不一致</strong>。
<ul>
<li><strong>例子</strong>：如果 LP 在 ETH 价格为 2000 USDT/ETH 时添加了 5 ETH 和 10,000 USDT，但之后 ETH 价格上涨，池中 ETH 变少，USDT 变多，LP 移除时可能会获得少于 5 ETH 但多于 10,000 USDT 的资产。</li>
</ul>
</li>
<li><strong>撤底池 (Rug Pull)</strong>：
<ul>
<li><strong>定义</strong>：项目方将所有初始提供的流动性全部移除。</li>
<li><strong>含义</strong>：通常意味着项目方“跑路”，导致代币失去流动性，价格暴跌。</li>
</ul>
</li>
<li><strong>K 值变化</strong>：移除流动性时，池中的 $X$ 和 $Y$ 都会减少，因此 <strong>K 值会减少</strong> ($K_{new} &lt; K_{old}$)。</li>
</ul>
<hr>
<h3 class="heading-element" id="6-amm-交易流程-mermaid-diagram"><span>6. AMM 交易流程 (Mermaid Diagram)</span>
  <a href="#6-amm-%e4%ba%a4%e6%98%93%e6%b5%81%e7%a8%8b-mermaid-diagram" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><div class="diagram-container">
  <pre class="mermaid">graph TD
    A[用户发起交易请求] --> B{选择交易对和数量};
    B --> C{计算预期价格和滑点};
    C --> D{用户确认交易};
    D -- (X * Y = K) --> E[更新池子中Token数量];
    E --> F[计算实际成交价格];
    F --> G{用户收到Token};
    G --> H[套利机器人监测价格差异];
    H -- (若存在套利机会) --> I[套利机器人执行交易];
    I --> E;</pre>
  <pre class="mermaid-dark">graph TD
    A[用户发起交易请求] --> B{选择交易对和数量};
    B --> C{计算预期价格和滑点};
    C --> D{用户确认交易};
    D -- (X * Y = K) --> E[更新池子中Token数量];
    E --> F[计算实际成交价格];
    F --> G{用户收到Token};
    G --> H[套利机器人监测价格差异];
    H -- (若存在套利机会) --> I[套利机器人执行交易];
    I --> E;</pre>
  <pre class="mermaid-neutral">graph TD
    A[用户发起交易请求] --> B{选择交易对和数量};
    B --> C{计算预期价格和滑点};
    C --> D{用户确认交易};
    D -- (X * Y = K) --> E[更新池子中Token数量];
    E --> F[计算实际成交价格];
    F --> G{用户收到Token};
    G --> H[套利机器人监测价格差异];
    H -- (若存在套利机会) --> I[套利机器人执行交易];
    I --> E;</pre><div class="diagram-copy-btn" aria-label="Copy Mermaid code" role="button"><i class="fa-regular fa-clone fa-width-auto" aria-hidden="true"></i></div>
<template><pre>graph TD
    A[用户发起交易请求] --> B{选择交易对和数量};
    B --> C{计算预期价格和滑点};
    C --> D{用户确认交易};
    D -- (X * Y = K) --> E[更新池子中Token数量];
    E --> F[计算实际成交价格];
    F --> G{用户收到Token};
    G --> H[套利机器人监测价格差异];
    H -- (若存在套利机会) --> I[套利机器人执行交易];
    I --> E;</pre></template>
</div><p><strong>流程解释</strong>：</p>
<ol>
<li><strong>用户发起交易请求</strong>：用户决定要交换的代币对（例如 ETH/USDT）和数量。</li>
<li><strong>计算预期价格和滑点</strong>：AMM 根据当前池中代币的比例计算理论上的预期价格，并预估此次交易可能产生的滑点。用户在此阶段会看到预估的滑点，并可以设置<strong>滑点容忍度</strong>。</li>
<li><strong>用户确认交易</strong>：用户审查预期价格和滑点后，决定是否执行交易。</li>
<li><strong>更新池子中 Token 数量</strong>：一旦交易确认，AMM 会根据核心公式 $X \times Y = K$ 来调整池中两种代币的数量。例如，用户卖出 ETH，池中 ETH 增加，USDT 减少。</li>
<li><strong>计算实际成交价格</strong>：根据更新后的池子状态，确定最终的成交价格。</li>
<li><strong>用户收到 Token</strong>：用户收到其购买的代币。</li>
<li><strong>套利机器人监测价格差异</strong>：在整个过程中，套利机器人持续监控 AMM 池内的价格与外部市场价格。</li>
<li><strong>套利机器人执行交易</strong>：如果 AMM 价格与外部市场价格存在差异，套利机器人会立即执行交易，在价格较低的地方买入，在价格较高的地方卖出，从而赚取利润。</li>
<li><strong>更新池子中 Token 数量 (通过套利)</strong>：套利交易也会导致池中代币数量更新，这有助于将 AMM 池的价格重新校准到与外部市场一致。</li>
</ol>
<hr>
<h3 class="heading-element" id="7-总结"><span>7. 总结</span>
  <a href="#7-%e6%80%bb%e7%bb%93" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><strong>CPAMM 核心</strong>：$X \times Y = K$ 是其基石，实现了去中心化环境下的自动化做市。</li>
<li><strong>K 值动态</strong>：
<ul>
<li>在<strong>代币交换 (Swap)</strong> 过程中，K 值保持恒定。</li>
<li>在<strong>添加流动性</strong>和<strong>移除流动性</strong>时，K 值会发生变化（增加或减少）。</li>
</ul>
</li>
<li><strong>滑点关键</strong>：交易量占池子总流动性的比例是影响滑点大小的关键因素。交易量越大，池子越浅，滑点越大。用户可以通过设置<strong>滑点容忍度</strong>来控制交易风险。</li>
<li><strong>流动性提供者</strong>：LP 通过提供流动性来赚取手续费，但需注意无常损失和移除流动性时资产比例可能变化的问题。</li>
</ul>
</div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod"><span title="更新于 2025-08-30 00:00:00">更新于 2025-08-30&nbsp;</span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"><span><a href="vscode://file//Users/ghostasky/Blog/content/posts/202509-AMM/index.md" title="在编辑器中打开" target="_blank" rel="external nofollow noopener noreferrer" class="link-to-vscode">在编辑器中打开</a></span></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="分享到 X" data-sharer="twitter" data-url="http://localhost:1313/posts/202509-amm/" data-title="恒定乘积自动做市商 (CPAMM) 学习笔记" data-hashtags="Web3"><i class="fa-brands fa-x-twitter" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="http://localhost:1313/posts/202509-amm/" data-hashtag="Web3"><i class="fa-brands fa-facebook-square" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="http://localhost:1313/posts/202509-amm/" data-title="恒定乘积自动做市商 (CPAMM) 学习笔记"><i class="fa-brands fa-weibo" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags me-1" aria-hidden="true"></i><a href="/tags/web3/" class="post-tag" title="标签 - Web3">Web3</a></section>
    <section><span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
    </section>
  </div><div class="post-nav"><a href="/posts/202508-tao/" class="post-nav-item" rel="prev" title="Lex Fridman播客:陶哲轩：数学、物理学中最难的问题以及人工智能的未来"><i class="fa-solid fa-angle-left" aria-hidden="true"></i>Lex Fridman播客:陶哲轩：数学、物理学中最难的问题以及人工智能的未来</a><a href="/posts/202509-jiedai/" class="post-nav-item" rel="next" title="去中心化借贷">去中心化借贷<i class="fa-solid fa-angle-right" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="目录"><h2 class="toc-title">目录&nbsp;<i class="toc-icon fa-solid fa-angle-down" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside><dialog id="toc-dialog" aria-labelledby="toc-dialog-title" role="dialog">
      <div class="toc">
        <h2 class="toc-title">目录</h2>
        <div class="toc-content" id="toc-content-drawer"><nav >
  <ul>
    <li><a href="#恒定乘积自动做市商-cpamm-学习笔记">恒定乘积自动做市商 (CPAMM) 学习笔记</a>
      <ul>
        <li><a href="#核心摘要-key-takeaways">核心摘要 (Key Takeaways)</a></li>
        <li><a href="#1-恒定乘积自动做市商-cpamm-核心原理">1. 恒定乘积自动做市商 (CPAMM) 核心原理</a></li>
        <li><a href="#2-案例展示与计算">2. 案例展示与计算</a></li>
        <li><a href="#3-价格与滑点-slippage">3. 价格与滑点 (Slippage)</a></li>
        <li><a href="#4-流动性与提供者">4. 流动性与提供者</a></li>
        <li><a href="#5-添加与移除流动性">5. 添加与移除流动性</a></li>
        <li><a href="#6-amm-交易流程-mermaid-diagram">6. AMM 交易流程 (Mermaid Diagram)</a></li>
        <li><a href="#7-总结">7. 总结</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
      </div>
    </dialog></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">由 <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.154.5"><img class="hugo-icon" src="/images/hugo.min.svg" alt="Hugo logo" /> Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.4.3-20260123080729-2a5bd268"><img class="fixit-icon" src="/images/fixit.min.svg" alt="FixIt logo" /> FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2026</span><span class="author" itemprop="copyrightHolder">
              <a href="/"></a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons"><div class="fixed-button back-to-top animate__faster d-none" role="button" aria-label="回到顶部"><i class="fa-solid fa-arrow-up" aria-hidden="true"></i></div><div id="toc-drawer-button" class="fixed-button toc-drawer-button d-none" role="button" aria-label="目录"><i class="fa-solid fa-bars" aria-hidden="true"></i></div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">该网站在启用 JavaScript 的情况下效果最佳。</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script src="/js/config/07b1666a89fb180a8b8dbeecf0244005.js" defer></script><script src="/js/lib/mermaid.js" type="module"></script><script src="/js/theme.min.js" defer></script></body>
</html>
