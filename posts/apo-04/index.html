<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>《高级投资组合优化》阅读笔记-第四章 - 敬渊&#39;s Blog</title><meta name="author" content="">
<meta name="description" content="第四章 在本章中，我们将解释如何构建风险因子模型，试图将资产收益表现作为风险因子表现的函数来解释。然后，基于这些模型，我们可以将资产收益的预期收益向量和协方差矩阵估计为风险因子的函数，这些风险因子可以是显性的（外生变量）或隐性的（外生变量的主成分）。与仅使用基于样本的参数估计作为投资组合优化模型的输入相比，这些新的估计方法往往能产生更多样化和稳健的投资组合。
"><meta name="keywords" content='量化'>
  <meta itemprop="name" content="《高级投资组合优化》阅读笔记-第四章">
  <meta itemprop="description" content="第四章 在本章中，我们将解释如何构建风险因子模型，试图将资产收益表现作为风险因子表现的函数来解释。然后，基于这些模型，我们可以将资产收益的预期收益向量和协方差矩阵估计为风险因子的函数，这些风险因子可以是显性的（外生变量）或隐性的（外生变量的主成分）。与仅使用基于样本的参数估计作为投资组合优化模型的输入相比，这些新的估计方法往往能产生更多样化和稳健的投资组合。">
  <meta itemprop="datePublished" content="2025-09-20T00:00:00+00:00">
  <meta itemprop="dateModified" content="2025-09-20T00:00:00+00:00">
  <meta itemprop="wordCount" content="8928">
  <meta itemprop="keywords" content="量化"><meta property="og:url" content="http://localhost:1313/posts/apo-04/">
  <meta property="og:site_name" content="敬渊&#39;s Blog">
  <meta property="og:title" content="《高级投资组合优化》阅读笔记-第四章">
  <meta property="og:description" content="第四章 在本章中，我们将解释如何构建风险因子模型，试图将资产收益表现作为风险因子表现的函数来解释。然后，基于这些模型，我们可以将资产收益的预期收益向量和协方差矩阵估计为风险因子的函数，这些风险因子可以是显性的（外生变量）或隐性的（外生变量的主成分）。与仅使用基于样本的参数估计作为投资组合优化模型的输入相比，这些新的估计方法往往能产生更多样化和稳健的投资组合。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-09-20T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-09-20T00:00:00+00:00">
    <meta property="article:tag" content="量化">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="《高级投资组合优化》阅读笔记-第四章">
  <meta name="twitter:description" content="第四章 在本章中，我们将解释如何构建风险因子模型，试图将资产收益表现作为风险因子表现的函数来解释。然后，基于这些模型，我们可以将资产收益的预期收益向量和协方差矩阵估计为风险因子的函数，这些风险因子可以是显性的（外生变量）或隐性的（外生变量的主成分）。与仅使用基于样本的参数估计作为投资组合优化模型的输入相比，这些新的估计方法往往能产生更多样化和稳健的投资组合。">
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="http://localhost:1313/posts/apo-04/" title="《高级投资组合优化》阅读笔记-第四章 - 敬渊&#39;s Blog" /><link rel="prev" type="text/html" href="http://localhost:1313/posts/202509-uniswapv2source/" title="UniswapV2源码阅读" /><link rel="next" type="text/html" href="http://localhost:1313/posts/apo-03/" title="《高级投资组合优化》阅读笔记-第三章 3.1 矩" /><link rel="stylesheet" href="/css/config.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "《高级投资组合优化》阅读笔记-第四章",
    "inLanguage": "zh-CN",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/localhost:1313\/posts\/apo-04\/"
    },"genre": "posts","keywords": "量化","wordcount":  8928 ,
    "url": "http:\/\/localhost:1313\/posts\/apo-04\/","datePublished": "2025-09-20T00:00:00+00:00","dateModified": "2025-09-20T00:00:00+00:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "作者"
      },"description": ""
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-instant-intensity="viewport" data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="敬渊&#39;s Blog"><span class="header-title-text">敬渊&#39;s Blog</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/posts/">文章</a></li><li class="menu-item">
              <a class="menu-link" href="/tags/">标签</a></li><li class="menu-item">
              <a class="menu-link" href="/about/">关于</a></li><li class="menu-item">
              <a class="menu-link" href="/categories/">分类</a></li><li class="menu-item delimiter"></li><li class="menu-item theme-switch" role="button" aria-label="切换主题" title="切换主题"><i class="fa-solid fa-adjust" aria-hidden="true"></i></li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="敬渊&#39;s Blog"><span class="header-title-text">敬渊&#39;s Blog</span></a><span class="header-subtitle"></span></div>
      <div class="theme-switch" role="button" aria-label="切换主题"><i class="fa-solid fa-adjust" aria-hidden="true"></i></div>
      <div class="menu-toggle" id="menu-toggle-mobile" role="button" aria-labelledby="menu-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="menu-item"><a class="menu-link" href="/posts/">文章</a></li><li class="menu-item"><a class="menu-link" href="/tags/">标签</a></li><li class="menu-item"><a class="menu-link" href="/about/">关于</a></li><li class="menu-item"><a class="menu-link" href="/categories/">分类</a></li><li class="menu-item menu-system"></li>
      </ul>
    </nav>
  </div>
</header><main class="fi-container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="合集"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>《高级投资组合优化》阅读笔记-第四章</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><i class="fa-solid fa-user-circle" aria-hidden="true"></i>
      Anonymous</span></span><span class="post-included-in">&nbsp;收录于 <a href="/categories/technology/" class="post-category" title="分类 - Technology"><i class="fa-regular fa-folder" aria-hidden="true"></i> Technology</a></span></div><div class="post-meta-line"><span title="发布于 2025-09-20 00:00:00"><i class="fa-solid fa-calendar-days me-1" aria-hidden="true"></i><time datetime="2025-09-20">2025-09-20</time></span>&nbsp;<span title="8928 字"><i class="fa-solid fa-pencil-alt me-1" aria-hidden="true"></i>约 9000 字</span>&nbsp;<span><i class="fa-regular fa-clock me-1" aria-hidden="true"></i>预计阅读 18 分钟</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>目录</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#1-核心思想多因子解释收益">1. 核心思想：多因子解释收益</a></li>
            <li><a href="#2-模型的数学表达">2. 模型的数学表达</a></li>
            <li><a href="#3-模型的统计性质">3. 模型的统计性质</a></li>
            <li><a href="#4-优点与缺点">4. 优点与缺点</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#42-显性因子模型-explicit-factors-models">4.2 显性因子模型 (Explicit Factors Models)</a>
      <ul>
        <li><a href="#421-fama-french-三因子模型">4.2.1 Fama-French 三因子模型</a>
          <ul>
            <li><a href="#1-核心思想市场规模与价值">1. 核心思想：市场、规模与价值</a></li>
            <li><a href="#2-模型的数学表达-1">2. 模型的数学表达</a></li>
            <li><a href="#3-模型的统计性质与应用">3. 模型的统计性质与应用</a></li>
            <li><a href="#4-优点与局限性">4. 优点与局限性</a></li>
          </ul>
        </li>
        <li><a href="#422-债券的关键利率久期与凸性模型">4.2.2 债券的关键利率久期与凸性模型</a>
          <ul>
            <li><a href="#1-核心思想分解收益率曲线风险">1. 核心思想：分解收益率曲线风险</a></li>
            <li><a href="#2-模型的数学表达-2">2. 模型的数学表达</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#43-隐性因子模型-implicit-factor-models">4.3 隐性因子模型 (Implicit Factor Models)</a>
      <ul>
        <li><a href="#431-主成分回归-principal-components-regression-pcr">4.3.1 主成分回归 (Principal Components Regression, PCR)</a>
          <ul>
            <li><a href="#0-什么是主成分分析-pca">0. 什么是主成分分析 (PCA)？</a></li>
            <li><a href="#1-核心思想降维与去相关">1. 核心思想：降维与去相关</a></li>
            <li><a href="#2-模型的数学表达与步骤">2. 模型的数学表达与步骤</a></li>
            <li><a href="#3-作为风险因子模型">3. 作为风险因子模型</a></li>
            <li><a href="#4-主要应用">4. 主要应用</a></li>
            <li><a href="#5-优点与局限性">5. 优点与局限性</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h1 class="heading-element" id="第四章"><span>第四章</span>
  <a href="#%e7%ac%ac%e5%9b%9b%e7%ab%a0" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h1><p>在本章中，我们将解释如何构建风险因子模型，试图将资产收益表现作为风险因子表现的函数来解释。然后，基于这些模型，我们可以将资产收益的预期收益向量和协方差矩阵估计为风险因子的函数，这些风险因子可以是显性的（外生变量）或隐性的（外生变量的主成分）。与仅使用基于样本的参数估计作为投资组合优化模型的输入相比，这些新的估计方法往往能产生更多样化和稳健的投资组合。</p>
<h1 class="heading-element" id="41-一般风险因子模型-general-risk-factor-models"><span>4.1 一般风险因子模型 (General Risk Factor Models)</span>
  <a href="#41-%e4%b8%80%e8%88%ac%e9%a3%8e%e9%99%a9%e5%9b%a0%e5%ad%90%e6%a8%a1%e5%9e%8b-general-risk-factor-models" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h1><p>作为资本资产定价模型 (CAPM) 的替代方案，Ross (1976) 基于套利理论推导出了一个资产定价模型，称为<strong>套利定价理论 (APT)</strong>。APT 认为资产的预期收益与多个风险因子线性相关，这与 CAPM 仅将其与单一风险因子（市场超额收益）相关联的观点不同。</p>
<p>APT 的优势在于它不具体规定这些风险因子是什么，只假设资产收益与风险因子之间存在线性关系。这使得风险建模比 CAPM 更为灵活，同时该方法允许消除非系统性风险，使得投资者仅因承担系统性风险因子而获得补偿。</p>
<h4 class="heading-element" id="1-核心思想多因子解释收益"><span>1. 核心思想：多因子解释收益</span>
  <a href="#1-%e6%a0%b8%e5%bf%83%e6%80%9d%e6%83%b3%e5%a4%9a%e5%9b%a0%e5%ad%90%e8%a7%a3%e9%87%8a%e6%94%b6%e7%9b%8a" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>多风险因子模型的核心思想是：任何资产的收益率都可以被分解为两部分：</p>
<ol>
<li><strong>可解释部分（系统性收益 / Systematic Return）</strong>：由一系列共同的风险因子 (Common Risk Factors) 及其该资产对因子的敏感度 (暴露程度) 所决定。例如利率变化、通货膨胀、行业景气度等。这种风险无法通过分散化投资来消除，因此投资者承担这部分风险时，会要求相应的回报补偿。</li>
<li><strong>不可解释部分（非系统性收益 / Idiosyncratic Return）</strong>：资产特有的、随机的回报部分 ( idiosyncratic return)，该部分与所有风险因子无关。</li>
</ol>
<h4 class="heading-element" id="2-模型的数学表达"><span>2. 模型的数学表达</span>
  <a href="#2-%e6%a8%a1%e5%9e%8b%e7%9a%84%e6%95%b0%e5%ad%a6%e8%a1%a8%e8%be%be" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>假设有 $n$ 个资产，每个资产的收益率可以表示为：</p>
<p>$$
r_{i} = \alpha_{i} + \beta_{i,1}f_{1} + \beta_{i,2}f_{2} + \ldots + \beta_{i,k}f_{k} + \epsilon_{i} = \alpha_{i} + \sum_{j = 1}^{K}\beta_{i,j}f_{j} + \epsilon_{i} \tag{4.1}
$$</p>
<p>其中：</p>
<ul>
<li>$r_i$：第 $i$ 个资产的收益率。</li>
<li>$\alpha_i$：第 $i$ 个资产的截距项或者说。在严格无套利条件下，$\alpha_i$应为零；在实证或主动管理语境下称其为“Alpha”。</li>
<li>$f_j$：第 $j$ 个<strong>共同风险因子</strong>的收益率或变化值（例如，GDP增长率、利率变化、油价波动等）。</li>
<li>$\beta_{i,j}$：第 $i$ 个资产对第 $j$ 个风险因子的<strong>敏感度</strong>或<strong>因子暴露</strong> (Factor Loading)。它衡量的是当因子 $f_j$ 变动 1% 时，资产 $i$ 的收益率平均变动多少，或者说资产 $i$ 回报的敏感程度。</li>
<li>$\epsilon_i$：第 $i$ 个资产的<strong>特质性收益​</strong> (Idiosyncratic Return) 或残差项，代表无法被共同风险因子解释的部分。</li>
</ul>
<p><strong>模型的关键假设</strong>：</p>
<ol>
<li>$\mathrm{E}[\epsilon_{i}] = 0$：特质性收益的期望值为零。</li>
<li>$\mathrm{E}[\epsilon_{i}\epsilon_{j}] = 0, \forall i\neq j$：任何两个不同资产的特质性收益<strong>不相关</strong>。</li>
<li>$\mathrm{E}[\epsilon_{i}f_{j}] = 0$：任何资产的特质性收益与<strong>所有风险因子不相关</strong>。</li>
</ol>
<p>将所有资产的方程堆叠在一起，可以得到简洁的矩阵形式：
$$
R = \alpha +FB^{\prime} + \epsilon  \tag{4.2}
$$
$$
R = \left[ \begin{array}{c}r_{1}\ r_{2}\ \vdots \ r_{n} \end{array} \right]^{\prime},\alpha = \left[ \begin{array}{c}\alpha_{1}\ \alpha_{2}\ \vdots \ \alpha_{n} \end{array} \right]^{\prime},B = \left[ \begin{array}{c}\beta_{1,1}\beta_{1,2}\dots \beta_{1,k}\ \beta_{2,1}\beta_{2,2}\dots \beta_{2,k}\ \vdots \vdots \ddots \vdots \ \beta_{n,1}\beta_{n,2}\dots \beta_{n,k} \end{array} \right],F = \left[ \begin{array}{c}f_{1}\ f_{2}\ \vdots \ f_{k} \end{array} \right]^{\prime},\epsilon = \left[ \begin{array}{c}\epsilon_{1}\ \epsilon_{2}\ \vdots \ \epsilon_{n} \end{array} \right]^{\prime} \tag{4.3}
$$</p>
<p>其中：</p>
<ul>
<li>$R$：资产收益率向量 ($n \times 1$)</li>
<li>$\alpha$：资产截距项向量 ($n \times 1$)</li>
<li>$B$：<strong>因子载荷矩阵</strong> ($n \times k$)，每一行代表一个资产，每一列代表该资产对相应因子的敏感度。包含了所有资产对所有因子的敏感度 $\beta_{i,j}$。这是模型的核心矩阵。</li>
<li>$F$：风险因子收益率向量 ($k \times 1$)</li>
<li>$\epsilon$：特质性收益向量 ($n \times 1$)</li>
</ul>
<h4 class="heading-element" id="3-模型的统计性质"><span>3. 模型的统计性质</span>
  <a href="#3-%e6%a8%a1%e5%9e%8b%e7%9a%84%e7%bb%9f%e8%ae%a1%e6%80%a7%e8%b4%a8" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>基于模型表达式和基本假设，我们可以推导出资产回报的期望和协方差。</p>
<ul>
<li>
<p><strong>期望收益向量 ($\mu_{\mathrm{FM}}$)</strong>:
对公式 (4.2) 两边取期望，并利用 $\mathrm{E}[\epsilon]=0$ 和 $\mathrm{E}[F] = \mu_F$：
$$
\mu_{\mathrm{FM}} = \mathrm{E}[R] = \alpha + B \mu_{F} \tag{4.4}
$$
<strong>结论</strong>：资产的预期回报由两部分构成：其自身的Alpha ($\alpha$)，以及它所承担的各种系统性风险的预期回报之和 ($B\mu_{\mathrm{F}}$)。其中 $B$ 是因子载荷矩阵，$\mu_F$ 是风险因子的预期回报向量。</p>
<p><strong>含义</strong>：资产的预期收益等于其截距项加上其因子暴露与因子预期收益的加权和。</p>
</li>
<li>
<p><strong>协方差矩阵 ($\Sigma_{\mathrm{FM}}$)</strong>:
资产收益率的协方差矩阵由两部分构成：
$$
\Sigma_{\mathrm{FM}} = B \Sigma_{F} B^{\prime} + \Sigma_{\epsilon} \tag{4.5}
$$</p>
<ul>
<li>$B \Sigma_{F} B^{\prime}$：<strong>系统性风险</strong>（系统性协方差矩阵）。由共同因子的波动 ($\Sigma_F$) 及其资产对因子的敏感度 ($B$) 共同决定。这部分风险是<strong>不可分散</strong>的。</li>
<li>$\Sigma_{\epsilon}$：<strong>非系统性风险</strong>（特质性风险）。根据模型假设，$\Sigma_{\epsilon}$ 是一个<strong>对角矩阵</strong>，因为不同资产的特质性收益互不相关。这部分风险是<strong>可分散</strong>的（通过构建投资组合）。</li>
</ul>
</li>
</ul>
<h4 class="heading-element" id="4-优点与缺点"><span>4. 优点与缺点</span>
  <a href="#4-%e4%bc%98%e7%82%b9%e4%b8%8e%e7%bc%ba%e7%82%b9" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p><strong>优点</strong>：</p>
<ol>
<li><strong>经济直觉强</strong>：模型试图捕捉收益产生的根本经济来源（风险因子）。</li>
<li><strong>估计稳健</strong>：相较于完全依赖历史数据的样本估计，基于因子模型的参数估计通常更稳健，尤其当资产数量很大时。</li>
<li><strong>降维高效</strong>：在估计大量资产的协方差矩阵时，因子模型只需估计因子协方差矩阵 $\Sigma_F$（维度k×k）和特质方差矩阵 $\Sigma_\epsilon$（对角矩阵），大大减少了待估参数的数量。</li>
</ol>
<p><strong>缺点与挑战</strong>：</p>
<ol>
<li><strong>因子选择难题 (Factor Specification)</strong>：模型本身并未指明应包含哪些风险因子。选择不同的因子集会导致完全不同的结果，如果因子选择错误，模型会被错误设定。</li>
<li><strong>正定性问题 (Positive Definiteness)</strong>：由于估计误差，根据公式 (4.5) 计算出的协方差矩阵 $\Sigma_{\mathrm{FM}}$ <strong>可能不是正定矩阵</strong>，而这对于许多投资组合优化算法（如均值-方差模型）是必需条件。解决方法通常是寻找最近的半正定矩阵进行替代，或者回退到样本协方差矩阵。</li>
<li><strong>近似处理</strong>：在实践中，有时会忽略特质性风险项，近似地使用 $\Sigma_{\mathrm{FM}}\approx B\Sigma_{F}B^{\prime}$。虽然简化了计算，但需要后续调整以确保矩阵的正定性。</li>
</ol>
<h2 class="heading-element" id="42-显性因子模型-explicit-factors-models"><span>4.2 显性因子模型 (Explicit Factors Models)</span>
  <a href="#42-%e6%98%be%e6%80%a7%e5%9b%a0%e5%ad%90%e6%a8%a1%e5%9e%8b-explicit-factors-models" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>显性因子模型是一类特殊的多因子模型，其核心特征是所使用的风险因子具有明确的经济或市场含义，并且通常有可直接观测或构建的代理变量。这些因子不是通过统计方法（如主成分分析）从数据中提取的，而是基于特定的金融或经济理论预先定义好的。</p>
<h3 class="heading-element" id="421-fama-french-三因子模型"><span>4.2.1 Fama-French 三因子模型</span>
  <a href="#421-fama-french-%e4%b8%89%e5%9b%a0%e5%ad%90%e6%a8%a1%e5%9e%8b" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>最著名的显性风险因子模型是<strong>Fama-French三因子模型</strong>，由 Eugene Fama 和 Kenneth French 于1993年提出。该模型是对资本资产定价模型 (CAPM) 的重大扩展，它认为股票的超额收益不仅由市场风险解释，还受到公司<strong>规模</strong>和<strong>估值</strong>两个重要风险因子的驱动。</p>
<h4 class="heading-element" id="1-核心思想市场规模与价值"><span>1. 核心思想：市场、规模与价值</span>
  <a href="#1-%e6%a0%b8%e5%bf%83%e6%80%9d%e6%83%b3%e5%b8%82%e5%9c%ba%e8%a7%84%e6%a8%a1%e4%b8%8e%e4%bb%b7%e5%80%bc" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>Fama-French模型的核心思想是，投资者因承担三种系统性风险而获得补偿：</p>
<ol>
<li><strong>市场风险 (Market Risk)</strong>：承担整体市场波动的风险（源自CAPM）。</li>
<li><strong>规模风险 (Size Risk)</strong>：投资于小市值公司所带来的特有风险。实证发现，小公司通常比大公司有更高的预期收益。</li>
<li><strong>价值风险 (Value Risk)</strong>：投资于价值股（相对于成长股）所带来的风险。实证发现，低估值公司通常比高估值公司有更高的预期收益。</li>
</ol>
<blockquote>
<p>该模型认为，除了承担整体市场的系统性风险外，投资者还额外承担了两种风险：<strong>规模风险</strong>和<strong>价值风险</strong>。因此，一项资产的超额回报，应该由它在这三个风险因子上的暴露程度共同决定。</p>
</blockquote>
<p>该模型通过构建两个特殊的投资组合来捕捉后两种风险：</p>
<ul>
<li><strong>SMB (Small Minus Big)</strong>：<strong>规模因子</strong>。它代表做多一个小市值公司投资组合的同时做空一个大市值公司投资组合的收益。正的SMB收益意味着小盘股表现优于大盘股。</li>
<li><strong>HML (High Minus Low)</strong>：<strong>价值因子</strong>。它代表做多一个高账面市值比（价值型）公司投资组合的同时做空一个低账面市值比（成长型）公司投资组合的收益。正的HML收益意味着价值股表现优于成长股。</li>
</ul>
<h4 class="heading-element" id="2-模型的数学表达-1"><span>2. 模型的数学表达</span>
  <a href="#2-%e6%a8%a1%e5%9e%8b%e7%9a%84%e6%95%b0%e5%ad%a6%e8%a1%a8%e8%be%be-1" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>对于任一资产 $i$，其超额收益可以被表示为以下三个因子的线性函数：</p>
<p>$$
r_{i} - r_{f} = \alpha_{i} + \beta_{i,M}(r_{m} - r_{f}) + \beta_{i,S}\mathrm{SMB} + \beta_{i,V}\mathrm{HML} + \epsilon_{i} \tag{4.6}
$$</p>
<p>其中：</p>
<ul>
<li>$r_{i} - r_{f}$：资产 $i$ 的<strong>超额收益</strong> (Excess Return)，即资产回报率减去无风险利率。这是我们希望解释的变量。</li>
<li>$r_{m} - r_{f}$：<strong>市场风险溢价</strong> (Market Risk Premium)。这是 CAPM 中唯一的因子，代表了持有市场投资组合所获得的、超越无风险利率的回报。</li>
<li>$\mathrm{SMB}$：规模因子收益。</li>
<li>$\mathrm{HML}$：价值因子收益。</li>
<li>$\alpha_{i}$：<strong>截距项</strong>。在模型被正确设定的情况下，它应接近于零，表示无法被三个因子解释的平均超额收益。</li>
<li>$\beta_{i,M}, \beta_{i,S}, \beta_{i,V}$：资产 $i$ 分别对市场、规模、价值三个因子的<strong>敏感度（因子载荷）</strong>。</li>
<li>$\epsilon_{i}$：<strong>残差项</strong>，代表资产特有的、不能被三个共同因子解释的收益部分。</li>
</ul>
<p>为了与一般因子模型（公式4.2）的矩阵形式保持一致，我们可以进行如下设定：</p>
<p>$$
R = \alpha + F B^{\prime} + \epsilon
$$</p>
<p>其中：</p>
<ul>
<li>$R = \begin{bmatrix} r_{1} - r_{f} \ r_{2} - r_{f} \ \vdots \ r_{n} - r_{f} \end{bmatrix}^{\prime}$：<strong>资产超额收益向量</strong>。</li>
<li>$\alpha = \begin{bmatrix} \alpha_{1} \ \alpha_{2} \ \vdots \ \alpha_{n} \end{bmatrix}^{\prime}$：<strong>各资产的Alpha向量</strong>。</li>
<li>$B = \begin{bmatrix} \beta_{1,M} &amp; \beta_{1,S} &amp; \beta_{1,V} \ \beta_{2,M} &amp; \beta_{2,S} &amp; \beta_{2,V} \ \vdots &amp; \vdots &amp; \vdots \ \beta_{n,M} &amp; \beta_{n,S} &amp; \beta_{n,V} \end{bmatrix}$：<strong>因子载荷矩阵</strong>。</li>
<li>$F = \begin{bmatrix} r_{m} - r_{f} \ \mathrm{SMB} \ \mathrm{HML} \end{bmatrix}^{\prime}$：<strong>因子收益向量</strong>。</li>
<li>$\epsilon = \begin{bmatrix} \epsilon_{1} \ \epsilon_{2} \ \vdots \ \epsilon_{n} \end{bmatrix}^{\prime}$：<strong>残差向量</strong>。</li>
</ul>
<h4 class="heading-element" id="3-模型的统计性质与应用"><span>3. 模型的统计性质与应用</span>
  <a href="#3-%e6%a8%a1%e5%9e%8b%e7%9a%84%e7%bb%9f%e8%ae%a1%e6%80%a7%e8%b4%a8%e4%b8%8e%e5%ba%94%e7%94%a8" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>Fama-French模型作为一般因子模型的一个特例，其统计性质完全遵循4.1节中的推导。</p>
<ul>
<li>
<p><strong>期望收益</strong>：
$$
\mathrm{E}[R] = \alpha + B \mathrm{E}[F]
$$
资产的预期超额收益等于其Alpha值加上其因子暴露与因子预期收益的加权和。</p>
</li>
<li>
<p><strong>协方差矩阵</strong>：
$$
\Sigma_{R} = B \Sigma_{F} B^{\prime} + \Sigma_{\epsilon}
$$
资产收益的总风险由因子风险 ($B \Sigma_{F} B^{\prime}$) 和特质风险 ($\Sigma_{\epsilon}$) 构成。</p>
</li>
</ul>
<p><strong>主要应用</strong>：</p>
<ol>
<li><strong>业绩归因</strong>：将基金或投资组合的超额收益分解为来自市场择时（Alpha）、市场风险暴露、规模因子暴露和价值因子暴露的贡献。一个显著的正Alpha通常被视为基金经理的选股能力。</li>
<li><strong>风险建模</strong>：更精确地估计大量资产的协方差矩阵，用于投资组合优化和风险管理。</li>
<li><strong>学术研究</strong>：作为检验市场有效性和资产定价理论的基准模型。</li>
</ol>
<h4 class="heading-element" id="4-优点与局限性"><span>4. 优点与局限性</span>
  <a href="#4-%e4%bc%98%e7%82%b9%e4%b8%8e%e5%b1%80%e9%99%90%e6%80%a7" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p><strong>优点</strong>：</p>
<ul>
<li><strong>强大的解释力</strong>：相较于单因子的CAPM，该模型对股票横截面收益率的解释力显著增强，能更好地捕捉平均收益的差异。</li>
<li><strong>经济直觉清晰</strong>：规模与价值因子具有明确的经济含义，易于理解和沟通。</li>
<li><strong>操作性强</strong>：因子的构建方法（基于市值和账面市值比排序）公开透明，数据易于获取，便于学术检验和实际应用。</li>
</ul>
<p><strong>局限性与批评</strong>：</p>
<ul>
<li><strong>理论基础薄弱</strong>：模型主要源于实证发现而非先验的理论推导。SMB和HML因子究竟代表了何种根本性经济风险（Source of Risk），至今仍在争论。</li>
<li><strong>数据挖掘嫌疑</strong>：有批评认为，这些因子可能是数据过拟合的结果，其有效性在未来样本外可能无法持续（<strong>样本外有效性问题</strong>）。此外，因子的成功也导致了<strong>因子拥挤</strong>的风险，大量资金采用类似策略会侵蚀超额收益。</li>
<li><strong>因子缺失</strong>：模型未能完全解释所有的市场异象，最著名的便是<strong>动量效应</strong>（后被Carhart四因子模型纳入）。这也引出了为何最初是这三个因子，而非其他因子的疑问。</li>
<li><strong>机理解释存疑</strong>：价值溢价和规模溢价的来源尚无定论，无法区分究竟是源于无法分散的宏观经济风险（风险补偿），还是源于投资者的行为偏差（非理性定价）。</li>
</ul>
<p>尽管如此，Fama-French三因子模型因其开创性的贡献，至今仍是金融学界和业界最重要、应用最广泛的多因子模型之一，为后续的因子研究奠定了坚实的基础。</p>
<h3 class="heading-element" id="422-债券的关键利率久期与凸性模型"><span>4.2.2 债券的关键利率久期与凸性模型</span>
  <a href="#422-%e5%80%ba%e5%88%b8%e7%9a%84%e5%85%b3%e9%94%ae%e5%88%a9%e7%8e%87%e4%b9%85%e6%9c%9f%e4%b8%8e%e5%87%b8%e6%80%a7%e6%a8%a1%e5%9e%8b" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>除了股票，显性因子模型同样广泛应用于固定收益领域。<strong>关键利率久期与凸性模型 (Key Rate Durations and Convexities Model)</strong> 就是一个典型的例子，它将债券的收益（或价格变动）解释为一系列关键点利率变化的函数。</p>
<p>该模型是对传统久期概念的深化。传统的久期（如修正久期）衡量的是债券价格对整个收益率曲线<strong>平行移动</strong>的敏感度，这是一个过于简化的假设。而在现实中，收益率曲线的变动是复杂的，可能变陡、变平或扭曲。关键利率久期模型正是为了捕捉这种<strong>非平行移动</strong>的风险。</p>
<h4 class="heading-element" id="1-核心思想分解收益率曲线风险"><span>1. 核心思想：分解收益率曲线风险</span>
  <a href="#1-%e6%a0%b8%e5%bf%83%e6%80%9d%e6%83%b3%e5%88%86%e8%a7%a3%e6%94%b6%e7%9b%8a%e7%8e%87%e6%9b%b2%e7%ba%bf%e9%a3%8e%e9%99%a9" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>该模型的核心思想是将债券对利率的总体敏感性分解为对收益率曲线上几个**“关键利率点” (Key Rates)** 变化的敏感性之和。常用的关键利率点包括2年、5年、10年、30年等期限的利率。</p>
<blockquote>
<p>债券价格的变动，可以近似地看作是其对每个关键点利率变化的反应的线性叠加，并通过凸性项进行二阶修正，从而更精确地捕捉由收益率曲线形态变化所带来的风险。</p>
</blockquote>
<p>模型的构建基于对债券定价函数的泰勒展开：</p>
<ol>
<li><strong>一阶项 (久期)</strong>：使用<strong>关键利率久期 (Key Rate Duration, KRD)</strong> 来衡量债券价格对某一个特定关键利率点变化的敏感度，同时假设曲线上其他点利率保持不变。</li>
<li><strong>二阶项 (凸性)</strong>：使用<strong>关键利率凸性 (Key Rate Convexity, KRC)</strong> 来修正久期在利率发生较大变化时的线性近似误差，提升模型的精度。</li>
</ol>
<h4 class="heading-element" id="2-模型的数学表达-2"><span>2. 模型的数学表达</span>
  <a href="#2-%e6%a8%a1%e5%9e%8b%e7%9a%84%e6%95%b0%e5%ad%a6%e8%a1%a8%e8%be%be-2" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>对于任一债券 $i$，其价格的百分比变动可以表示为：</p>
<p>$$\frac{V_{i,\Delta r}-V_{0}}{V_{0}} \approx \sum_{j=1}^{k} \left( -KRD_{i,j} \cdot \Delta r_{j} + \frac{1}{2} \cdot KRC_{i,j} \cdot \Delta r_{j}^{2} \right) + \epsilon_{i} \tag{4.9}$$</p>
<p>其中：</p>
<ul>
<li>$\frac{V_{i,\Delta r}-V_{0}}{V_{0}}$：债券 $i$ 的<strong>持有期回报率</strong>或价格的百分比变动。这是被解释变量。</li>
<li>$k$：所选取的关键利率点的个数。</li>
<li>$\Delta r_{j}$：第 $j$ 个关键利率的变化量。这是模型的<strong>风险因子</strong>。</li>
<li>$KRD_{i,j}$：债券 $i$ 对第 $j$ 个关键利率的<strong>关键利率久期</strong>。它衡量了在其他利率不变的情况下，第 $j$ 个关键利率变动1%时，债券价格的百分比变动。</li>
<li>$KRC_{i,j}$：债券 $i$ 对第 $j$ 个关键利率的<strong>关键利率凸性</strong>。</li>
<li>$\epsilon_{i}$：<strong>残差项</strong>，代表无法被关键利率变化解释的价格变动部分。</li>
</ul>
<p>该模型可以表示为更一般的风险因子模型（公式4.2）的矩阵形式，但需要注意其特定的结构。其矩阵形式为：</p>
<p>$$
R = F B^{\prime} + \epsilon \tag{4.10}
$$</p>
<p>其中：</p>
<ol>
<li><strong>债券价格变化向量 $R$</strong>：
$$
R = \begin{bmatrix}
\Delta V_{1,\Delta r} % \
\Delta V_{2,\Delta r} % \
\vdots \
\Delta V_{n,\Delta r} %
\end{bmatrix}^{\prime}
$$
<ul>
<li>维度：$1 \times n$</li>
<li>这是$n$只债券价格的<strong>百分比变化</strong>组成的<strong>行向量</strong>，$\Delta V_{i,\Delta r} % = \frac{V_{i,\Delta r} - V_0}{V_0}$ 表示第$i$只债券的价格变化百分比</li>
</ul>
</li>
<li><strong>因子载荷矩阵 $B$</strong>：
$$
B = \begin{bmatrix}
KRD_{1,1} &amp; \cdots &amp; KRD_{1,k} &amp; KRC_{1,1} &amp; \cdots &amp; KRC_{1,k} \
KRD_{2,1} &amp; \cdots &amp; KRD_{2,k} &amp; KRC_{2,1} &amp; \cdots &amp; KRC_{2,k} \
\vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \
KRD_{n,1} &amp; \cdots &amp; KRD_{n,k} &amp; KRC_{n,1} &amp; \cdots &amp; KRC_{n,k}
\end{bmatrix}^{\prime}
$$
<ul>
<li>维度：$(2k) \times n$</li>
<li>这是<strong>因子载荷矩阵的转置</strong>，其元素是债券对各因子的敏感度（即经过符号和系数调整的KRD和KRC）</li>
<li>每列对应一个债券：前$k$个元素是它的关键利率久期(KRD)，后$k$个元素是它的关键利率凸性(KRC)</li>
</ul>
</li>
<li><strong>因子变化向量 $F$</strong>：
$$
F = \begin{bmatrix}
\Delta r_{1} \
\vdots \
\Delta r_{k} \
\Delta r_{1}^{2} \
\vdots \
\Delta r_{k}^{2}
\end{bmatrix}^{\prime}
$$
<ul>
<li>维度：$1 \times (2k)$，代表<strong>因子收益率</strong>。它由关键利率的变化及其平方项构成。</li>
<li>包含所有关键利率的<strong>一次项变化</strong>($\Delta r_j$)和<strong>二次项变化</strong>($\Delta r_j^2$)</li>
</ul>
</li>
</ol>
<ul>
<li>$F = \begin{bmatrix} \Delta r_{1} &amp; \cdots &amp; \Delta r_{k} &amp; \Delta r_{1}^{2} &amp; \cdots &amp; \Delta r_{k}^{2} \end{bmatrix}$：一个 $1 \times 2k$ 的行向量，代表<strong>因子收益率</strong>。它由关键利率的变化及其平方项构成。</li>
<li>$\epsilon$：<strong>残差向量</strong>。</li>
</ul>
<p>在此特定模型中，<strong>没有截距项 $\alpha$</strong>。因为当所有关键利率变化为零时，债券价格的预期变化应为零。</p>
<h2 class="heading-element" id="43-隐性因子模型-implicit-factor-models"><span>4.3 隐性因子模型 (Implicit Factor Models)</span>
  <a href="#43-%e9%9a%90%e6%80%a7%e5%9b%a0%e5%ad%90%e6%a8%a1%e5%9e%8b-implicit-factor-models" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>隐性因子模型与显性因子模型的关键区别在于，其风险因子并非预先由经济理论定义，而是通过统计方法从资产收益数据中<strong>提取</strong>或<strong>推断</strong>出来的。这些因子代表了数据中存在的、共同驱动资产收益变化的潜在力量。</p>
<h3 class="heading-element" id="431-主成分回归-principal-components-regression-pcr"><span>4.3.1 主成分回归 (Principal Components Regression, PCR)</span>
  <a href="#431-%e4%b8%bb%e6%88%90%e5%88%86%e5%9b%9e%e5%bd%92-principal-components-regression-pcr" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>主成分回归是一种结合了主成分分析（PCA）和多元回归的技术，主要用于解决预测变量之间存在<strong>多重共线性</strong>的问题。在金融领域，多重共线性是普遍存在的，因为许多宏观经济变量和风格因子之间高度相关。PCR通过将原始的相关变量转换为一组不相关的“主成分”来克服这一难题。</p>
<h4 class="heading-element" id="0-什么是主成分分析-pca"><span>0. 什么是主成分分析 (PCA)？</span>
  <a href="#0-%e4%bb%80%e4%b9%88%e6%98%af%e4%b8%bb%e6%88%90%e5%88%86%e5%88%86%e6%9e%90-pca" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>想象一下，你有一组关于很多人的数据，比如每个人的“身高”和“体重”。这两个变量是相关的（通常个子高的人体重也更重）。现在，我给你一张图，上面每个点代表一个人（x轴是身高，y轴是体重），你的任务是：<strong>找到一个新的视角来看这些数据，使得这个新视角能最好地展示出人们之间的差异</strong>。</p>
<p><strong>主成分分析 (PCA)</strong> 就是做这件事的数学工具。它会为你找到一组<strong>新的坐标轴</strong>（称为“主成分”），这组新坐标轴有两个关键特性：</p>
<ol>
<li><strong>彼此垂直（正交）</strong>：这意味着新的坐标轴之间完全没有相关性。第一个新轴（主成分1）捕捉了数据中最主要的变化方向（即身高和体重共同变动的趋势）。第二个新轴（主成分2）必须与第一个垂直，并捕捉剩余的最主要变化。</li>
<li><strong>按重要性排序</strong>：第一个主成分(PC1)是那个从新视角看，数据点分布最分散（方差最大）的方向。第二个主成分(PC2)是与PC1垂直的方向中，数据点最分散的，依此类推。</li>
</ol>
<p><strong>在金融中的比喻</strong>：
假设你的因子是“GDP增长率”和“消费者信心指数”，它们很可能同时向好或向坏（即高度相关）。PCA会生成两个新的因子：</p>
<ul>
<li><strong>PC1 (宏观景气因子)</strong>：可能 ≈ 0.7 * GDP增长 + 0.7 * 消费者信心。它捕捉了“整体经济好坏”这个最主要的共同趋势。</li>
<li><strong>PC2 (微观差异因子)</strong>：可能 ≈ 0.7 * GDP增长 - 0.7 * 消费者信心。它捕捉了“GDP和消费者信心不同步”的次要趋势（例如，GDP增长但人们却悲观）。</li>
</ul>
<p>所以，PCA就是一个<strong>数据旋转和重新投影</strong>的工具，目的是找到数据内部隐藏的、不相关的“主驱动方向”。</p>
<h4 class="heading-element" id="1-核心思想降维与去相关"><span>1. 核心思想：降维与去相关</span>
  <a href="#1-%e6%a0%b8%e5%bf%83%e6%80%9d%e6%83%b3%e9%99%8d%e7%bb%b4%e4%b8%8e%e5%8e%bb%e7%9b%b8%e5%85%b3" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>PCR的核心思想分为两步：</p>
<ol>
<li><strong>降维 (Dimensionality Reduction)</strong>：使用PCA从$k$个可能存在多重共线性的原始风险因子中，提取出少数$p$个（$p &lt; k$）<strong>主成分</strong>。这些主成分是原始变量的线性组合，能够捕捉原始数据中绝大部分的变异信息。</li>
<li><strong>回归 (Regression)</strong>：使用这$p$个互不相关的主成分作为新的预测变量，对资产收益进行回归。由于主成分之间是正交的（不相关），彻底消除了多重共线性的影响。</li>
</ol>
<p>最终，我们将从“主成分世界”得到的估计结果，转换回“原始变量世界”进行解释。</p>
<h4 class="heading-element" id="2-模型的数学表达与步骤"><span>2. 模型的数学表达与步骤</span>
  <a href="#2-%e6%a8%a1%e5%9e%8b%e7%9a%84%e6%95%b0%e5%ad%a6%e8%a1%a8%e8%be%be%e4%b8%8e%e6%ad%a5%e9%aa%a4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>PCR的建模过程包含一系列标准化的数据处理和变换步骤。</p>
<p><strong>步骤 1: 定义原始模型</strong>
我们从包含$k$个原始风险因子的标准线性回归模型开始，该模型用于解释第$i$个资产的收益：
$$
\begin{array}{l}{{y_{i}=\beta_{0}+\beta_{1}x_{i,1}+\cdot\cdot\cdot+\beta_{k}x_{i,k}+\epsilon_{i}}}\ {{Y={\bf 1}<em>{T}\beta</em>{0}+X\beta+\epsilon}}\end{array} \tag{4.12}
$$
其中$Y$是资产收益向量，$X$是原始因子矩阵，$\mathbf{1}_{T}$是元素为1的列向量。</p>
<p><strong>步骤 2: 标准化变量</strong>
为了消除量纲影响并确保PCA结果不受变量尺度的影响，对原始预测变量进行标准化：
$$
\begin{array}{l}{{x_{j}^{S}=\frac{x_{j}-\bar{x}<em>{j}}{S</em>{j}}}}\ \end{array} \tag{4.13}
$$
其中$S_{j}$是变量$x_j$的样本标准差。得到标准化后的矩阵$X^S$。</p>
<p><strong>步骤 3: 标准化回归模型</strong>
将标准化后的变量代入原模型，得到等价的标准化回归模型：
$$
\begin{array}{l}{{y_{i}=\beta_{0}^{S}+\beta_{1}^{S}\left[\frac{x_{i,1}-\bar{x}<em>{1}}{S</em>{1}}\right]+\cdot\cdot\cdot+\beta_{k}^{S}\left[\frac{x_{i,k}-\bar{x}<em>{k}}{S</em>{k}}\right]+\epsilon_{i}}}\ {{Y={\bf 1}<em>{T}\beta</em>{0}^{S}+X^{S}\beta^{S}+\epsilon}}\end{array} \tag{4.14}
$$
标准化系数 $\beta^{S}$ 与原始系数 $\beta$ 可以通过公式(4.15)进行转换。
$$
\begin{array}{l}{{\beta_{j}=\frac{\beta_{j}^{S}}{S_{j}}\ ,\ j=1,2,\cdots,k}}\ {{\beta_{0}=\beta_{0}^{S}-\frac{\beta_{1}^{S}\bar{x}<em>{1}}{S</em>{1}}-\cdots-\frac{\beta_{k}^{S}\bar{x}<em>{k}}{S</em>{k}}}}\ {{\beta_{0}^{S}=\bar{y}}}\end{array} \tag{4.15}
$$</p>
<p><strong>步骤 4: 计算主成分</strong>
对标准化后的因子矩阵$X^S$进行主成分分析。求解$X^{S^{\prime}}X^{S}$矩阵的特征值和特征向量：
$$
\begin{array}{r l} &amp; {\lambda = [\lambda_{1}\lambda_{2}\dots \lambda_{k}]}\ &amp; {V = [v_{1}v_{2}\dots v_{k}]}\ \end{array} \tag{4.16}
$$
其中特征值按大小降序排列($\lambda_1 &gt; \lambda_2 &gt; &hellip; &gt; \lambda_k$)，$v_j$是对应的单位特征向量，且不同特征向量相互正交。主成分$Z$则由$X^S$投影到这些特征向量上得到：
$$
Z=X^{S}V \tag{4.17}
$$
每个主成分$z_j$都是原始标准化变量的线性组合，且各主成分之间互不相关。</p>
<blockquote>
<p>为什么要求解 $X^{S^{\prime}}X^{S}$ 的特征值和特征向量？</p>
</blockquote>
<p>这里的 $X^{S^{\prime}}X^{S}$ 是一个非常关键的矩阵。在我们对原始数据 $X$ 进行标准化（均值为0，标准差为1）后，$X^{S^{\prime}}X^{S}$ 有一个特殊的名字：<strong>协方差矩阵</strong>。</p>
<ul>
<li><strong>这个矩阵的对角线元素</strong>是每个变量自身的方差（因为标准化过，所以都等于1）。</li>
<li><strong>这个矩阵的非对角线元素</strong>是不同变量两两之间的协方差（即相关性）。</li>
</ul>
<p><strong>我们的目标是：找到一组新的、不相关的坐标轴（主成分）。</strong>
“不相关”在数学上意味着“正交”。而<strong>特征向量(Eigenvectors)</strong> 天然的数学性质就是<strong>正交</strong>的！</p>
<p><strong>求解 $X^{S^{\prime}}X^{S}$ 的特征值和特征向量，实际上就是在问：</strong></p>
<blockquote>
<p>“协方差矩阵 $X^{S^{\prime}}X^{S}$，你的主要‘拉伸’方向是哪几个？这些方向上的‘拉伸’力度又有多大？”</p>
</blockquote>
<ul>
<li><strong>特征向量 ($V$)</strong> 的回答是：<strong>“我的主要拉伸方向是这些……”</strong>。每一个特征向量 $v_j$ 就定义了一个<strong>主成分的方向</strong>。$X^S$ 投影到 $v_j$ 上就得到了第 $j$ 个主成分 $z_j = X^S v_j$。</li>
<li><strong>特征值 ($\lambda$)</strong> 的回答是：<strong>“在这个方向上，数据分布的方差（分散程度）有这么大……”</strong>。特征值 $\lambda_j$ 的大小直接衡量了其对应的主成分 $z_j$ 所包含的<strong>信息量（方差）</strong>。</li>
</ul>
<p><strong>总结：</strong> 求解协方差矩阵 $X^{S^{\prime}}X^{S}$ 的特征系统和特征值，是为了<strong>自动地、数学地</strong>找出数据方差最大的那些<strong>正交方向</strong>，这些方向就是我们想要的主成分。</p>
<p><strong>步骤 5 &amp; 6: 主成分回归与降维</strong>
利用主成分和其正交性，我们将原模型重写并选择前$p$个主成分（通常根据特征值大于1或累计贡献率&gt;85%的标准）来构建一个新的、无多重共线性的回归模型：
$$
Y={\bf 1}<em>{T}\beta</em>{0}^{S}+Z_{p}\alpha_{p}+\epsilon \tag{4.19}
$$
其中$Z_p = X^S V_p$，$V_p$由前$p$个特征向量组成。</p>
<p><strong>步骤 7: 系数转换</strong>
最后，我们将基于主成分得到的系数估计$\alpha_p$转换回原始标准化变量的系数$\beta_{pc}^{S}$，进而通过公式(4.20)转换回原始尺度下的系数$\beta_{pc}$进行最终解释。</p>
<p>$$
\begin{array}{l}{{\beta_{j,p c}=\frac{\beta_{j,p c}^{S}}{S_{j}}~,~j=1,2,\cdots,k}}\ {{\beta_{0,p c}=\beta_{0,p c}^{S}-\frac{\beta_{1,p c}^{S}\bar{x}<em>{1}}{S</em>{1}}-\cdots-\frac{\beta_{k}^{S}\bar{x}<em>{k}}{S</em>{k}}}}\ {{\beta_{0,p c}^{S}=\bar{y}}}\end{array} \tag{4.20}
$$</p>
<h4 class="heading-element" id="3-作为风险因子模型"><span>3. 作为风险因子模型</span>
  <a href="#3-%e4%bd%9c%e4%b8%ba%e9%a3%8e%e9%99%a9%e5%9b%a0%e5%ad%90%e6%a8%a1%e5%9e%8b" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>在金融风险建模的语境下，PCR为我们提供了一种构建隐性因子模型的方法。提取出的主成分$Z_p$本身就是一组<strong>隐性风险因子</strong>。</p>
<ul>
<li><strong>因子</strong>：$F = Z_p$，即前$p$个主成分。它们是不可直接观测的、统计推导出的共同风险驱动因子。</li>
<li><strong>因子载荷</strong>：$B$矩阵中的元素$\beta_{i,j,pc}$衡量了资产$i$对第$j$个主成分因子（隐性风险）的暴露程度。</li>
</ul>
<p>因此，资产的收益可以被表示为：
$$
R = \alpha + F B^{\prime} + \epsilon \tag{4.21}
$$
其中，$R$是资产收益向量，$\alpha$是截距项向量，$F$是主成分因子收益矩阵，$B$是由PCR最终估计出的因子载荷矩阵。</p>
<h4 class="heading-element" id="4-主要应用"><span>4. 主要应用</span>
  <a href="#4-%e4%b8%bb%e8%a6%81%e5%ba%94%e7%94%a8" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><ol>
<li><strong>处理高度共线性的因子</strong>：当候选因子集高度相关时（如一系列估值因子），PCR可以提取出其中独立的共同趋势。</li>
<li><strong>降维与简化模型</strong>：用少数几个主成分替代大量原始变量，使模型更简洁、稳定。</li>
<li><strong>估计高维协方差矩阵</strong>：当资产数量$n$很大时，直接估计$n \times n$的样本协方差矩阵非常困难且不准确。使用PCR，只需估计少数主成分的协方差矩阵$\Sigma_F$和残差协方差矩阵$\Sigma_\epsilon$，再通过$\Sigma_R = B \Sigma_F B&rsquo; + \Sigma_\epsilon$重构资产协方差矩阵，大幅提高了估计效率和稳健性。</li>
</ol>
<h4 class="heading-element" id="5-优点与局限性"><span>5. 优点与局限性</span>
  <a href="#5-%e4%bc%98%e7%82%b9%e4%b8%8e%e5%b1%80%e9%99%90%e6%80%a7" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p><strong>优点</strong>：</p>
<ul>
<li><strong>彻底解决多重共线性</strong>：产生正交的预测变量，使得系数估计稳定且唯一。</li>
<li><strong>避免过拟合</strong>：通过保留主要成分、舍弃次要成分，降低了模型对噪声的敏感度，提高了样本外预测能力。</li>
<li><strong>计算高效</strong>：PCA和回归都有成熟且高效的计算算法。</li>
</ul>
<p><strong>局限性</strong>：</p>
<ul>
<li><strong>解释性差</strong>：主成分是原始变量的线性组合，其经济含义往往模糊不清，难以像“价值”、“规模”那样直接解释。</li>
<li><strong>信息损失</strong>：舍弃后$k-p$个主成分必然会导致部分信息损失。主成分的选择（$p$值的确定）具有一定的主观性。</li>
<li><strong>对标准化的依赖</strong>：结果严重依赖于变量的标准化。如果某个重要变量的方差很小，它可能在主成分中的贡献被低估。</li>
</ul>
</div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod"><span title="更新于 2025-09-20 00:00:00">更新于 2025-09-20&nbsp;</span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"><span><a href="vscode://file//Users/ghostasky/Blog/content/posts/APO-04/index.md" title="在编辑器中打开" target="_blank" rel="external nofollow noopener noreferrer" class="link-to-vscode">在编辑器中打开</a></span></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="分享到 X" data-sharer="twitter" data-url="http://localhost:1313/posts/apo-04/" data-title="《高级投资组合优化》阅读笔记-第四章" data-hashtags="量化"><i class="fa-brands fa-x-twitter" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="http://localhost:1313/posts/apo-04/" data-hashtag="量化"><i class="fa-brands fa-facebook-square" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="http://localhost:1313/posts/apo-04/" data-title="《高级投资组合优化》阅读笔记-第四章"><i class="fa-brands fa-weibo" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags me-1" aria-hidden="true"></i><a href="/tags/%E9%87%8F%E5%8C%96/" class="post-tag" title="标签 - 量化">量化</a></section>
    <section><span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
    </section>
  </div><div class="post-nav"><a href="/posts/202509-uniswapv2source/" class="post-nav-item" rel="prev" title="UniswapV2源码阅读"><i class="fa-solid fa-angle-left" aria-hidden="true"></i>UniswapV2源码阅读</a><a href="/posts/apo-03/" class="post-nav-item" rel="next" title="《高级投资组合优化》阅读笔记-第三章 3.1 矩">《高级投资组合优化》阅读笔记-第三章 3.1 矩<i class="fa-solid fa-angle-right" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="目录"><h2 class="toc-title">目录&nbsp;<i class="toc-icon fa-solid fa-angle-down" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside><dialog id="toc-dialog" aria-labelledby="toc-dialog-title" role="dialog">
      <div class="toc">
        <h2 class="toc-title">目录</h2>
        <div class="toc-content" id="toc-content-drawer"><nav >
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#1-核心思想多因子解释收益">1. 核心思想：多因子解释收益</a></li>
            <li><a href="#2-模型的数学表达">2. 模型的数学表达</a></li>
            <li><a href="#3-模型的统计性质">3. 模型的统计性质</a></li>
            <li><a href="#4-优点与缺点">4. 优点与缺点</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#42-显性因子模型-explicit-factors-models">4.2 显性因子模型 (Explicit Factors Models)</a>
      <ul>
        <li><a href="#421-fama-french-三因子模型">4.2.1 Fama-French 三因子模型</a>
          <ul>
            <li><a href="#1-核心思想市场规模与价值">1. 核心思想：市场、规模与价值</a></li>
            <li><a href="#2-模型的数学表达-1">2. 模型的数学表达</a></li>
            <li><a href="#3-模型的统计性质与应用">3. 模型的统计性质与应用</a></li>
            <li><a href="#4-优点与局限性">4. 优点与局限性</a></li>
          </ul>
        </li>
        <li><a href="#422-债券的关键利率久期与凸性模型">4.2.2 债券的关键利率久期与凸性模型</a>
          <ul>
            <li><a href="#1-核心思想分解收益率曲线风险">1. 核心思想：分解收益率曲线风险</a></li>
            <li><a href="#2-模型的数学表达-2">2. 模型的数学表达</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#43-隐性因子模型-implicit-factor-models">4.3 隐性因子模型 (Implicit Factor Models)</a>
      <ul>
        <li><a href="#431-主成分回归-principal-components-regression-pcr">4.3.1 主成分回归 (Principal Components Regression, PCR)</a>
          <ul>
            <li><a href="#0-什么是主成分分析-pca">0. 什么是主成分分析 (PCA)？</a></li>
            <li><a href="#1-核心思想降维与去相关">1. 核心思想：降维与去相关</a></li>
            <li><a href="#2-模型的数学表达与步骤">2. 模型的数学表达与步骤</a></li>
            <li><a href="#3-作为风险因子模型">3. 作为风险因子模型</a></li>
            <li><a href="#4-主要应用">4. 主要应用</a></li>
            <li><a href="#5-优点与局限性">5. 优点与局限性</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav></div>
      </div>
    </dialog></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">由 <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.154.5"><img class="hugo-icon" src="/images/hugo.min.svg" alt="Hugo logo" /> Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.4.3-20260123080729-2a5bd268"><img class="fixit-icon" src="/images/fixit.min.svg" alt="FixIt logo" /> FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2026</span><span class="author" itemprop="copyrightHolder">
              <a href="/"></a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons"><div class="fixed-button back-to-top animate__faster d-none" role="button" aria-label="回到顶部"><i class="fa-solid fa-arrow-up" aria-hidden="true"></i></div><div id="toc-drawer-button" class="fixed-button toc-drawer-button d-none" role="button" aria-label="目录"><i class="fa-solid fa-bars" aria-hidden="true"></i></div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">该网站在启用 JavaScript 的情况下效果最佳。</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script src="/js/config/8b84bb571539b8cc29f32d0e87353397.js" defer></script><script src="/js/theme.min.js" defer></script></body>
</html>
